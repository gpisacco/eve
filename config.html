
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Configuration Handling &mdash; Eve 0.3-dev documentation</title>
    
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.3-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="Eve 0.3-dev documentation" href="index.html" />
    <link rel="next" title="Data Validation" href="validation.html" />
    <link rel="prev" title="Features" href="features.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body>
  
  

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="validation.html" title="Data Validation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="features.html" title="Features"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Eve 0.3-dev documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="configuration-handling">
<span id="config"></span><h1>Configuration Handling<a class="headerlink" href="#configuration-handling" title="Permalink to this headline">¶</a></h1>
<p>Generally Eve configuration is best done with configuration files. The
configuration files themselves are actual Python files.</p>
<div class="section" id="configuration-with-files">
<h2>Configuration with Files<a class="headerlink" href="#configuration-with-files" title="Permalink to this headline">¶</a></h2>
<p>On startup, Eve will look for a <cite>settings.py</cite> file in the application folder.
You can choose an alternative filename/path. Just pass it as an argument when
you instantiate the application.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">eve</span> <span class="kn">import</span> <span class="n">Eve</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Eve</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="s">&#39;my_settings.py&#39;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="configuration-with-a-dictionary">
<h2>Configuration with a Dictionary<a class="headerlink" href="#configuration-with-a-dictionary" title="Permalink to this headline">¶</a></h2>
<p>Alternatively, you can choose to provide a settings dictionary:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">my_settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;MONGO_HOST&#39;</span><span class="p">:</span> <span class="s">&#39;localhost&#39;</span><span class="p">,</span>
    <span class="s">&#39;MONGO_PORT&#39;</span><span class="p">:</span> <span class="mi">27017</span><span class="p">,</span>
    <span class="s">&#39;MONGO_DBNAME&#39;</span><span class="p">:</span> <span class="s">&#39;the_db_name&#39;</span>
    <span class="s">&#39;DOMAIN&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;contacts&#39;</span><span class="p">:</span> <span class="p">{}}</span>
<span class="p">}</span>

<span class="kn">from</span> <span class="nn">eve</span> <span class="kn">import</span> <span class="n">Eve</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Eve</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="n">my_settings</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="development-production">
<h2>Development / Production<a class="headerlink" href="#development-production" title="Permalink to this headline">¶</a></h2>
<p>Most applications need more than one configuration. There should be at least
separate configurations for the production server and the one used during
development. The easiest way to handle this is to use a default configuration
that is always loaded and part of the version control, and a separate
configuration that overrides the values as necessary.</p>
<p>This is the main reason why you can override or extend the settings with the
contents of the file the <span class="target" id="index-0"></span><tt class="xref std std-envvar docutils literal"><span class="pre">EVE_SETTINGS</span></tt> environment variable points to.
The development/local settings could be stored in <cite>settings.py</cite> and then, in
production, you could export EVE_SETTINGS=/path/to/production_setting.py, and
you are done.</p>
<p>There are many alternative ways to handle development/production
however. Using Python modules for configuration is very convenient, as they
allow for all kinds of nice tricks, like being able to seamlessly launch the
same API on both local and production systems, connecting to the appropriate
database instance as needed.  Consider the following example, taken directly
from the <a class="reference internal" href="index.html#demo"><em>Live demo</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># We want to run seamlessly our API both locally and on Heroku, so:</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;PORT&#39;</span><span class="p">):</span>
    <span class="c"># We&#39;re hosted on Heroku! Use the MongoHQ sandbox as our backend.</span>
    <span class="n">MONGO_HOST</span> <span class="o">=</span> <span class="s">&#39;alex.mongohq.com&#39;</span>
    <span class="n">MONGO_PORT</span> <span class="o">=</span> <span class="mi">10047</span>
    <span class="n">MONGO_USERNAME</span> <span class="o">=</span> <span class="s">&#39;&lt;user&gt;&#39;</span>
    <span class="n">MONGO_PASSWORD</span> <span class="o">=</span> <span class="s">&#39;&lt;pw&gt;&#39;</span>
    <span class="n">MONGO_DBNAME</span> <span class="o">=</span> <span class="s">&#39;&lt;dbname&gt;&#39;</span>

    <span class="c"># also, correctly set the API entry point</span>
    <span class="n">SERVER_NAME</span> <span class="o">=</span> <span class="s">&#39;eve-demo.herokuapp.com&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c"># Running on local machine. Let&#39;s just use the local mongod instance.</span>

    <span class="c"># Please note that MONGO_HOST and MONGO_PORT could very well be left</span>
    <span class="c"># out as they already default to a bare bones local &#39;mongod&#39; instance.</span>
    <span class="n">MONGO_HOST</span> <span class="o">=</span> <span class="s">&#39;localhost&#39;</span>
    <span class="n">MONGO_PORT</span> <span class="o">=</span> <span class="mi">27017</span>
    <span class="n">MONGO_USERNAME</span> <span class="o">=</span> <span class="s">&#39;user&#39;</span>
    <span class="n">MONGO_PASSWORD</span> <span class="o">=</span> <span class="s">&#39;user&#39;</span>
    <span class="n">MONGO_DBNAME</span> <span class="o">=</span> <span class="s">&#39;apitest&#39;</span>

    <span class="c"># let&#39;s not forget the API entry point</span>
    <span class="n">SERVER_NAME</span> <span class="o">=</span> <span class="s">&#39;localhost:5000&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="global-configuration">
<span id="global"></span><h2>Global Configuration<a class="headerlink" href="#global-configuration" title="Permalink to this headline">¶</a></h2>
<p>Besides defining the general API behavior, most global configuration settings
are used to define the standard endpoint ruleset, and can be fine-tuned later,
when configuring individual endpoints. Global configuration settings are always
uppercase.</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="62%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">SERVER_NAME</span></tt></td>
<td>Domain on which the API is being hosted.
Supports subdomains. Defaults to
<tt class="docutils literal"><span class="pre">localhost:5000</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">URL_PREFIX</span></tt></td>
<td>URL prefix for all API endpoints. Will be used
in conjunction with <tt class="docutils literal"><span class="pre">SERVER_NAME</span></tt> and
<tt class="docutils literal"><span class="pre">API_VERSION</span></tt> to construct all API urls
(e.g., <tt class="docutils literal"><span class="pre">api</span></tt> will be rendered to
<tt class="docutils literal"><span class="pre">localhost:5000/api/</span></tt>).  Defaults to <tt class="docutils literal"><span class="pre">''</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">API_VERSION</span></tt></td>
<td>API version. Will be used in conjunction with
<tt class="docutils literal"><span class="pre">SERVER_NAME</span></tt> and <tt class="docutils literal"><span class="pre">URL_PREFIX</span></tt> to construct
API urls (e.g., <tt class="docutils literal"><span class="pre">v1</span></tt> will be rendered to
<tt class="docutils literal"><span class="pre">localhost:5000/v1/</span></tt>). Defaults to <tt class="docutils literal"><span class="pre">''</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ALLOWED_FILTERS</span></tt></td>
<td><p class="first">List of fields on which filtering is allowed.
Can be set to <tt class="docutils literal"><span class="pre">[]</span></tt> (no filters allowed) or
<tt class="docutils literal"><span class="pre">['*']</span></tt> (filters allowed on every field).
Unless your API is comprised of just one
endpoint, this global setting should be used as
an on/off switch, delegating explicit
whitelisting at the local level (see
<tt class="docutils literal"><span class="pre">allowed_filters</span></tt> below). Defaults to
<tt class="docutils literal"><span class="pre">['*']</span></tt>.</p>
<p class="last"><em>Please note:</em> If API scraping or DB DoS
attacks are a concern, then globally disabling
filters and whitelisting valid ones at the local
level is the way to go.</p>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">SORTING</span></tt></td>
<td><tt class="docutils literal"><span class="pre">True</span></tt> if sorting is supported for <tt class="docutils literal"><span class="pre">GET</span></tt>
requests, otherwise <tt class="docutils literal"><span class="pre">False</span></tt>. Can be overridden
by resource settings. Defaults to <tt class="docutils literal"><span class="pre">True</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">PAGINATION</span></tt></td>
<td><tt class="docutils literal"><span class="pre">True</span></tt> if pagination is enabled for <tt class="docutils literal"><span class="pre">GET</span></tt>
requests, otherwise <tt class="docutils literal"><span class="pre">False</span></tt>. Can be overridden
by resource settings. Defaults to <tt class="docutils literal"><span class="pre">True</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">PAGINATION_LIMIT</span></tt></td>
<td>Maximum value allowed for <tt class="docutils literal"><span class="pre">max_results</span></tt>
querydef parameter. Values exceeding the limit
will be silently replaced with this value.
You want to aim for a reasonable compromise
between performance and transfer size. Defaults
to 50.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">PAGINATION_DEFAULT</span></tt></td>
<td>Default value for <tt class="docutils literal"><span class="pre">max_results</span></tt> applied when
the parameter is omitted.  Defaults to 25.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">DATE_FORMAT</span></tt></td>
<td>A Python date format used to parse and render
datetime values. When serving requests,
matching JSON strings will be parsed and stored as
<tt class="docutils literal"><span class="pre">datetime</span></tt> values. In responses, <tt class="docutils literal"><span class="pre">datetime</span></tt>
values will be rendered as JSON strings using
this format. Defaults to the RFC1123 (ex RFC
822) standard <tt class="docutils literal"><span class="pre">a,</span> <span class="pre">%d</span> <span class="pre">%b</span> <span class="pre">%Y</span> <span class="pre">%H:%M:%S</span> <span class="pre">GMT</span></tt>
(&#8220;Tue, 02 Apr 2013 10:29:13 GMT&#8221;).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">RESOURCE_METHODS</span></tt></td>
<td>A list of HTTP methods supported at resource
endpoints. Allowed values: <tt class="docutils literal"><span class="pre">GET</span></tt>, <tt class="docutils literal"><span class="pre">POST</span></tt>,
<tt class="docutils literal"><span class="pre">DELETE</span></tt>. <tt class="docutils literal"><span class="pre">POST</span></tt> is used for insertions.
<tt class="docutils literal"><span class="pre">DELETE</span></tt> will delete <em>all</em> resource contents
(enable with caution). Can be overridden by
resource settings. Defaults to <tt class="docutils literal"><span class="pre">['GET']</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">PUBLIC_METHODS</span></tt></td>
<td>A list of HTTP methods supported at resource
endpoints, open to public access even when
<a class="reference internal" href="authentication.html#auth"><em>Authentication and Authorization</em></a> is enabled. Can be overridden by
resource settings. Defaults to <tt class="docutils literal"><span class="pre">[]</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ITEM_METHODS</span></tt></td>
<td>A list of HTTP methods supported at item
endpoints. Allowed values: <tt class="docutils literal"><span class="pre">GET</span></tt>, <tt class="docutils literal"><span class="pre">PATCH</span></tt>
and <tt class="docutils literal"><span class="pre">DELETE</span></tt>. <tt class="docutils literal"><span class="pre">PATCH</span></tt> or, for clients not
supporting PATCH, <tt class="docutils literal"><span class="pre">POST</span></tt> with the
<tt class="docutils literal"><span class="pre">X-HTTP-Method-Override</span></tt> header tag, is used
for item updates; <tt class="docutils literal"><span class="pre">DELETE</span></tt> for item deletion.
Can be overridden by resource settings. Defaults
to <tt class="docutils literal"><span class="pre">['GET']</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">PUBLIC_ITEM_METHODS</span></tt></td>
<td>A list of HTTP methods supported at item
endpoints, left open to public access when when
<a class="reference internal" href="authentication.html#auth"><em>Authentication and Authorization</em></a> is enabled. Can be overridden by
resource settings. Defaults to <tt class="docutils literal"><span class="pre">[]</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ALLOWED_ROLES</span></tt></td>
<td>A list of allowed <cite>roles</cite> for resource
endpoints. Can be overridden by resource
settings. See <a class="reference internal" href="authentication.html#auth"><em>Authentication and Authorization</em></a> for more
information. Defaults to <tt class="docutils literal"><span class="pre">[]</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">ALLOWED_ITEM_ROLES</span></tt></td>
<td>A list of allowed <cite>roles</cite> for item endpoints.
See <a class="reference internal" href="authentication.html#auth"><em>Authentication and Authorization</em></a> for more information. Can be
overridden by resource settings.  Defaults to
<tt class="docutils literal"><span class="pre">[]</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">CACHE_CONTROL</span></tt></td>
<td>Value of the <tt class="docutils literal"><span class="pre">Cache-Control</span></tt> header field
used when serving <tt class="docutils literal"><span class="pre">GET</span></tt> requests (e.g.,
<tt class="docutils literal"><span class="pre">max-age=20,must-revalidate</span></tt>). Leave empty if
you don&#8217;t want to include cache directives with
API responses. Can be overridden by resource
settings. Defaults to <tt class="docutils literal"><span class="pre">''</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">CACHE_EXPIRES</span></tt></td>
<td>Value (in seconds) of the <tt class="docutils literal"><span class="pre">Expires</span></tt> header
field used when serving <tt class="docutils literal"><span class="pre">GET</span></tt> requests. If
set to a non-zero value, the header will
always be included, regardless of the setting
of <tt class="docutils literal"><span class="pre">CACHE_CONTROL</span></tt>. Can be overridden by
resource settings. Defaults to 0.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">X_DOMAINS</span></tt></td>
<td>CORS (Cross-Origin Resource Sharing) support.
Allows API maintainers to specify which domains
are allowed to perform CORS requests. Allowed
values are: <tt class="docutils literal"><span class="pre">None</span></tt>, a list of domains or &#8216;*&#8217;
for a wide-open API. Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">X_HEADERS</span></tt></td>
<td>CORS (Cross-Origin Resource Sharing) support.
Allows API maintainers to specify which headers
are allowed to be sent with CORS requests. Allowed
values are: <tt class="docutils literal"><span class="pre">None</span></tt> or a list of headers names.
Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">LAST_UPDATED</span></tt></td>
<td>Name of the field used to record a document&#8217;s
last update date. This field is automatically
handled by Eve. Defaults to <tt class="docutils literal"><span class="pre">_updated</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">DATE_CREATED</span></tt></td>
<td>Name for the field used to record a document
creation date. This field is automatically
handled by Eve. Defaults to <tt class="docutils literal"><span class="pre">_created</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ID_FIELD</span></tt></td>
<td>Name of the field used to uniquely identify
resource items within the database. You want
this field to be properly indexed on the
database.  Defaults to <tt class="docutils literal"><span class="pre">_id</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">ITEM_LOOKUP</span></tt></td>
<td><tt class="docutils literal"><span class="pre">True</span></tt> if item endpoints should be generally
available acroos the API, <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.
Can be overridden by resource settings. Defaults
to <tt class="docutils literal"><span class="pre">True</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ITEM_LOOKUP_FIELD</span></tt></td>
<td>Document field used when looking up a resource
item. Can be overridden by resource settings.
Defaults to <tt class="docutils literal"><span class="pre">ID_FIELD</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">ITEM_URL</span></tt></td>
<td>URL rule used to construct default item
endpoint URLs. Can be overridden by resource
settings. Defaults <tt class="docutils literal"><span class="pre">regex(&quot;[a-f0-9]{24}&quot;)</span></tt>
which is MongoDB standard <tt class="docutils literal"><span class="pre">Object_Id</span></tt> format.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ITEM_TITLE</span></tt></td>
<td>Title to be used when building item references,
both in XML and JSON responses. Defaults to
resource name, with the plural &#8216;s&#8217; stripped if
present. Can and most likely will be overridden
when configuring single resource endpoints.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">AUTH_FIELD</span></tt></td>
<td>Enables <a class="reference internal" href="authentication.html#user-restricted"><em>User-Restricted Resource Access</em></a>. When the
feature is enabled, users can only
read/update/delete resource items created by
themselves. The keyword contains the actual
name of the field used to store the id of
the user who created the resource item. Can be
overridden by resource settings. Defaults to
<tt class="docutils literal"><span class="pre">None</span></tt>, which disables the feature.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ALLOW_UNKNOWN</span></tt></td>
<td>When <tt class="docutils literal"><span class="pre">True</span></tt>, this option will allow insertion
of arbitrary, unknown fields to any API
endpoint. Use with caution. See <a class="reference internal" href="validation.html#unknown"><em>Allowing the Unknown</em></a>
for more information. Defaults to <tt class="docutils literal"><span class="pre">False</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">PROJECTION</span></tt></td>
<td>When <tt class="docutils literal"><span class="pre">True</span></tt>, this option enables the
<a class="reference internal" href="features.html#projections"><em>Projections</em></a> feature. Can be overridden
by resource settings. Defaults to <tt class="docutils literal"><span class="pre">True</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">EMBEDDING</span></tt></td>
<td>When <tt class="docutils literal"><span class="pre">True</span></tt> this option enables the
<a class="reference internal" href="features.html#embedded-docs"><em>Embedded Resource Serialization</em></a> feature. Defaults to
<tt class="docutils literal"><span class="pre">True</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">EXTRA_RESPONSE_FIELDS</span></tt></td>
<td>Allows to configure a list of additional
document fields that should be provided with
every POST response. Normally only
automatically handled fields (<tt class="docutils literal"><span class="pre">ID_FIELD</span></tt>,
<tt class="docutils literal"><span class="pre">LAST_UPDATED</span></tt>, <tt class="docutils literal"><span class="pre">DATE_CREATED</span></tt>, <tt class="docutils literal"><span class="pre">ETAG</span></tt>)
are included in response payloads. Can be
overridden by resource settings. Defaults to
<tt class="docutils literal"><span class="pre">[]</span></tt>, effectively disabling the feature.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">RATE_LIMIT_GET</span></tt></td>
<td>A tuple expressing the rate limit on GET
requests. The first element of the tuple is
the number of requests allowed, while the
second is the time window in seconds. For
example, <tt class="docutils literal"><span class="pre">(300,</span> <span class="pre">60</span> <span class="pre">*</span> <span class="pre">15)</span></tt> would set a limit
of 300 requests every 15 minutes. Defaults
to <tt class="docutils literal"><span class="pre">None</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">RATE_LIMIT_POST</span></tt></td>
<td>A tuple expressing the rate limit on POST
requests. The first element of the tuple is
the number of requests allowed, while the
second is the time window in seconds. For
example <tt class="docutils literal"><span class="pre">(300,</span> <span class="pre">60</span> <span class="pre">*</span> <span class="pre">15)</span></tt> would set a limit
of 300 requests every 15 minutes. Defaults
to <tt class="docutils literal"><span class="pre">None</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">RATE_LIMIT_PATCH</span></tt></td>
<td>A tuple expressing the rate limit on PATCH
requests. The first element of the tuple is
the number of requests allowed, while the
second is the time window in seconds. For
example <tt class="docutils literal"><span class="pre">(300,</span> <span class="pre">60</span> <span class="pre">*</span> <span class="pre">15)</span></tt> would set a limit
of 300 requests every 15 minutes. Defaults
to <tt class="docutils literal"><span class="pre">None</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">RATE_LIMIT_DELETE</span></tt></td>
<td>A tuple expressing the rate limit on DELETE
requests. The first element of the tuple is
the number of requests allowed, while the
second is the time window in seconds. For
example <tt class="docutils literal"><span class="pre">(300,</span> <span class="pre">60</span> <span class="pre">*</span> <span class="pre">15)</span></tt> would set a limit
of 300 requests every 15 minutes. Defaults
to <tt class="docutils literal"><span class="pre">None</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">DEBUG</span></tt></td>
<td><tt class="docutils literal"><span class="pre">True</span></tt> to enable Debug Mode, <tt class="docutils literal"><span class="pre">False</span></tt>
otherwise.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">HATEOAS</span></tt></td>
<td>When <tt class="docutils literal"><span class="pre">False</span></tt>, this option disables
<a class="reference internal" href="features.html#hateoas-feature"><em>HATEOAS</em></a>. Defaults to <tt class="docutils literal"><span class="pre">True</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ISSUES</span></tt></td>
<td>Allows to customize the issues field. Defaults
to <tt class="docutils literal"><span class="pre">_issues</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">STATUS</span></tt></td>
<td>Allows to customize the status field. Defaults
to <tt class="docutils literal"><span class="pre">_status</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">STATUS_OK</span></tt></td>
<td>Status message returned when data validation is
successful. Defaults to <tt class="docutils literal"><span class="pre">OK</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">STATUS_ERR</span></tt></td>
<td>Status message returned when data validation
failed. Defaults to <tt class="docutils literal"><span class="pre">ERR</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ITEMS</span></tt></td>
<td>Allows to customize the items field. Defaults
to <tt class="docutils literal"><span class="pre">_items</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">LINKS</span></tt></td>
<td>Allows to customize the links field. Defaults
to <tt class="docutils literal"><span class="pre">_links</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ETAG</span></tt></td>
<td>Allows to customize the etag field. Defaults
to <tt class="docutils literal"><span class="pre">_etag</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">IF_MATCH</span></tt></td>
<td><tt class="docutils literal"><span class="pre">True</span></tt> to enable concurrency control, <tt class="docutils literal"><span class="pre">False</span></tt>
otherwise. Defaults to <tt class="docutils literal"><span class="pre">True</span></tt>. See
<a class="reference internal" href="features.html#concurrency"><em>Data Integrity and Concurrency Control</em></a>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">XML</span></tt></td>
<td><tt class="docutils literal"><span class="pre">True</span></tt> to enable XML support, <tt class="docutils literal"><span class="pre">False</span></tt>
otherwise. See <a class="reference internal" href="features.html#jsonxml"><em>JSON and XML Rendering</em></a>. Defaults to
<tt class="docutils literal"><span class="pre">True</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">JSON</span></tt></td>
<td><tt class="docutils literal"><span class="pre">True</span></tt> to enable JSON support, <tt class="docutils literal"><span class="pre">False</span></tt>
otherwise. See <a class="reference internal" href="features.html#jsonxml"><em>JSON and XML Rendering</em></a>. Defaults to
<tt class="docutils literal"><span class="pre">True</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">MONGO_HOST</span></tt></td>
<td>MongoDB server address. Defaults to <tt class="docutils literal"><span class="pre">localhost</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">MONGO_PORT</span></tt></td>
<td>MongoDB port. Defaults to <tt class="docutils literal"><span class="pre">27017</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">MONGO_USERNAME</span></tt></td>
<td>MongoDB user name.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">MONGO_PASSWORD</span></tt></td>
<td>MongoDB password.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">MONGO_DBNAME</span></tt></td>
<td>MongoDB database name.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">MONGO_QUERY_BLACKLIST</span></tt></td>
<td><p class="first">A list of Mongo query operators that are not
allowed to be used in resource filters
(<tt class="docutils literal"><span class="pre">?where=</span></tt>). Defaults to <tt class="docutils literal"><span class="pre">['$where',</span>
<span class="pre">'$regex']</span></tt>.</p>
<p class="last">Mongo JavaScript operators are disabled by
default, as they might be used as vectors for
injection attacks. Javascript queries also tend
to be slow and generally can be easily replaced
with the (very rich) Mongo query dialect.</p>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">MONGO_WRITE_CONCERN</span></tt></td>
<td><p class="first">A dictionary defining MongoDB write concern
settings. All standard write concern settings
(w, wtimeout, j, fsync) are supported. Defaults
to <tt class="docutils literal"><span class="pre">{'w':</span> <span class="pre">1}</span></tt>, which means &#8216;do regular
acknowledged writes&#8217; (this is also the Mongo
default).</p>
<p>Please be aware that setting &#8216;w&#8217; to a value of
2 or greater requires replication to be active
or you will be getting 500 errors (the write
will still happen; Mongo will just be unable
to check that it&#8217;s being written to multiple
servers).</p>
<p class="last">Can be overridden at endpoint (Mongo
collection) level. See <tt class="docutils literal"><span class="pre">mongo_write_concern</span></tt>
below.</p>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">DOMAIN</span></tt></td>
<td>A dict holding the API domain definition.
See <a class="reference internal" href="#domain-configuration">Domain Configuration</a>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="domain-configuration">
<span id="domain"></span><h2>Domain Configuration<a class="headerlink" href="#domain-configuration" title="Permalink to this headline">¶</a></h2>
<p>In Eve terminology, a <cite>domain</cite> is the definition of the API structure, the area
where you design your API, fine-tune resources endpoints, and define validation
rules.</p>
<p><tt class="docutils literal"><span class="pre">DOMAIN</span></tt> is a <a class="reference internal" href="#global"><em>global configuration setting</em></a>: a Python
dictionary where keys are API resources and values their definitions.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Here we define two API endpoints, &#39;people&#39; and &#39;works&#39;, leaving their</span>
<span class="c"># definitions empty.</span>
<span class="n">DOMAIN</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;people&#39;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s">&#39;works&#39;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>In the following two sections, we will customize the <cite>people</cite> resource.</p>
<div class="section" id="resource-item-endpoints">
<span id="local"></span><h3>Resource / Item Endpoints<a class="headerlink" href="#resource-item-endpoints" title="Permalink to this headline">¶</a></h3>
<p>Endpoint customization is mostly done by overriding some <a class="reference internal" href="#global"><em>global settings</em></a>, but other unique settings are also available. Resource settings are
always lowercase.</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">url</span></tt></td>
<td><p class="first">The endpoint URL. If omitted the resource key
of the <tt class="docutils literal"><span class="pre">DOMAIN</span></tt> dict will be used to build
the URL. As an example, <tt class="docutils literal"><span class="pre">contacts</span></tt> would make
the <cite>people</cite> resource available at
<tt class="docutils literal"><span class="pre">/contacts</span></tt> (instead of <tt class="docutils literal"><span class="pre">/people</span></tt>). URL can
be as complex as needed and can be nested
relative to another API endpoint (you can have
a <tt class="docutils literal"><span class="pre">/contacts</span></tt> endpoint and then
a <tt class="docutils literal"><span class="pre">/contacts/overseas</span></tt> endpoint. Both are
independent of each other and freely
configurable).</p>
<p class="last">You can also use regexes to setup
subresource-like endpoints. See
<a class="reference internal" href="features.html#subresources"><em>Sub Resources</em></a>.</p>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">allowed_filters</span></tt></td>
<td><p class="first">List of fields on which filtering is allowed.
Can be set to <tt class="docutils literal"><span class="pre">[]</span></tt> (no filters allowed), or
<tt class="docutils literal"><span class="pre">['*']</span></tt> (fields allowed on every field).
Defaults to <tt class="docutils literal"><span class="pre">['*']</span></tt>.</p>
<p class="last"><em>Please note:</em> If API scraping or DB DoS
attacks are a concern, then globally disabling
filters (see <tt class="docutils literal"><span class="pre">ALLOWED_FILTERS</span></tt> above) and
then whitelisting valid ones at the local level
is the way to go.</p>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">sorting</span></tt></td>
<td><tt class="docutils literal"><span class="pre">True</span></tt> if sorting is enabled, <tt class="docutils literal"><span class="pre">False</span></tt>
otherwise. Locally overrides <tt class="docutils literal"><span class="pre">SORTING</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">pagination</span></tt></td>
<td><tt class="docutils literal"><span class="pre">True</span></tt> if pagination is enabled, <tt class="docutils literal"><span class="pre">False</span></tt>
otherwise. Locally overrides <tt class="docutils literal"><span class="pre">PAGINATION</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">resource_methods</span></tt></td>
<td><p class="first">A list of HTTP methods supported at resource
endpoint. Allowed values: <tt class="docutils literal"><span class="pre">GET</span></tt>, <tt class="docutils literal"><span class="pre">POST</span></tt>,
<tt class="docutils literal"><span class="pre">DELETE</span></tt>. Locally overrides
<tt class="docutils literal"><span class="pre">RESOURCE_METHODS</span></tt>.</p>
<p class="last"><em>Please note:</em> if you&#8217;re running version 0.0.5
or earlier use the now unsupported <tt class="docutils literal"><span class="pre">methods</span></tt>
keyword instead.</p>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">public_methods</span></tt></td>
<td>A list of HTTP methods supported at resource
endpoint, open to public access even when
<a class="reference internal" href="authentication.html#auth"><em>Authentication and Authorization</em></a> is enabled. Locally overrides
<tt class="docutils literal"><span class="pre">PUBLIC_METHODS</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">item_methods</span></tt></td>
<td>A list of HTTP methods supported at item
endpoint. Allowed values: <tt class="docutils literal"><span class="pre">GET</span></tt>, <tt class="docutils literal"><span class="pre">PATCH</span></tt>
and <tt class="docutils literal"><span class="pre">DELETE</span></tt>. <tt class="docutils literal"><span class="pre">PATCH</span></tt> or, for clients not
supporting PATCH, <tt class="docutils literal"><span class="pre">POST</span></tt> with the
<tt class="docutils literal"><span class="pre">X-HTTP-Method-Override</span></tt> header tag.
Locally overrides <tt class="docutils literal"><span class="pre">ITEM_METHODS</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">public_item_methods</span></tt></td>
<td>A list of HTTP methods supported at item
endpoint, left open to public access when
<a class="reference internal" href="authentication.html#auth"><em>Authentication and Authorization</em></a> is enabled. Locally overrides
<tt class="docutils literal"><span class="pre">PUBLIC_ITEM_METHODS</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">allowed_roles</span></tt></td>
<td>A list of allowed <cite>roles</cite> for resource
endpoint. See <a class="reference internal" href="authentication.html#auth"><em>Authentication and Authorization</em></a> for more
information. Locally overrides
<tt class="docutils literal"><span class="pre">ALLOWED_ROLES</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">allowed_item_roles</span></tt></td>
<td>A list of allowed <cite>roles</cite> for item endpoint.
See <a class="reference internal" href="authentication.html#auth"><em>Authentication and Authorization</em></a> for more information.
Locally overrides <tt class="docutils literal"><span class="pre">ALLOWED_ITEM_ROLES</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">cache_control</span></tt></td>
<td>Value of the <tt class="docutils literal"><span class="pre">Cache-Control</span></tt> header field
used when serving <tt class="docutils literal"><span class="pre">GET</span></tt> requests. Leave empty
if you don&#8217;t want to include cache directives
with API responses. Locally overrides
<tt class="docutils literal"><span class="pre">CACHE_CONTROL</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">cache_expires</span></tt></td>
<td>Value (in seconds) of the <tt class="docutils literal"><span class="pre">Expires</span></tt> header
field used when serving <tt class="docutils literal"><span class="pre">GET</span></tt> requests. If
set to a non-zero value, the header will
always be included, regardless of the setting
of <tt class="docutils literal"><span class="pre">CACHE_CONTROL</span></tt>. Locally overrides
<tt class="docutils literal"><span class="pre">CACHE_EXPIRES</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">item_lookup</span></tt></td>
<td><tt class="docutils literal"><span class="pre">True</span></tt> if item endpoint should be available,
<tt class="docutils literal"><span class="pre">False</span></tt> otherwise. Locally overrides
<tt class="docutils literal"><span class="pre">ITEM_LOOKUP</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">item_lookup_field</span></tt></td>
<td>Field used when looking up a resource
item. Locally overrides <tt class="docutils literal"><span class="pre">ITEM_LOOKUP_FIELD</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">item_url</span></tt></td>
<td>Rule used to construct item endpoint URL.
Locally overrides <tt class="docutils literal"><span class="pre">ITEM_URL</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">resource_title</span></tt></td>
<td>Title used when building resource links
(HATEOAS). Defaults to resource&#8217;s <tt class="docutils literal"><span class="pre">url</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">item_title</span></tt></td>
<td>Title to be used when building item references,
both in XML and JSON responses. Overrides
<tt class="docutils literal"><span class="pre">ITEM_TITLE</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">additional_lookup</span></tt></td>
<td>Besides the standard item endpoint which
defaults to <tt class="docutils literal"><span class="pre">/&lt;resource&gt;/&lt;ID_FIELD_value&gt;</span></tt>,
you can optionally define a secondary,
read-only, endpoint like
<tt class="docutils literal"><span class="pre">/&lt;resource&gt;/&lt;person_name&gt;</span></tt>. You do so by
defining a dictionary comprised of two items
<cite>field</cite> and <cite>url</cite>. The former is the name of
the field used for the lookup. If the field
type (as defined in the resource <a class="reference internal" href="#schema">schema</a>) is
a string, then you put a URL rule in <cite>url</cite>.  If
it is an integer, then you just omit <cite>url</cite>, as
it is automatically handled.  See the code
snippet below for an usage example of this
feature.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">datasource</span></tt></td>
<td>Explicitly links API resources to database
collections. See <a class="reference internal" href="#advanced-datasource-patterns">Advanced Datasource
Patterns</a>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">auth_field</span></tt></td>
<td>Enables <a class="reference internal" href="authentication.html#user-restricted"><em>User-Restricted Resource Access</em></a>. When the
feature is enabled, users can only
read/update/delete resource items created by
themselves. The keyword contains the actual
name of the field used to store the id of
the user who created the resource item. Locally
overrides <tt class="docutils literal"><span class="pre">AUTH_FIELD</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">allow_unknown</span></tt></td>
<td>When <tt class="docutils literal"><span class="pre">True</span></tt>, this option will allow insertion
of arbitrary, unknown fields to the endpoint.
Use with caution. Locally overrides
<tt class="docutils literal"><span class="pre">ALLOW_UNKNOWN</span></tt>. See <a class="reference internal" href="validation.html#unknown"><em>Allowing the Unknown</em></a> for more
information. Defaults to <tt class="docutils literal"><span class="pre">False</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">projection</span></tt></td>
<td>When <tt class="docutils literal"><span class="pre">True</span></tt>, this option enables the
<a class="reference internal" href="features.html#projections"><em>Projections</em></a> feature. Locally overrides
<tt class="docutils literal"><span class="pre">PROJECTION</span></tt>. Defaults to <tt class="docutils literal"><span class="pre">True</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">embedding</span></tt></td>
<td>When <tt class="docutils literal"><span class="pre">True</span></tt> this option enables the
<a class="reference internal" href="features.html#embedded-docs"><em>Embedded Resource Serialization</em></a> feature. Defaults to
<tt class="docutils literal"><span class="pre">True</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">extra_response_fields</span></tt></td>
<td>Allows to configure a list of additional
document fields that should be provided with
every POST response. Normally only
automatically handled fields (<tt class="docutils literal"><span class="pre">ID_FIELD</span></tt>,
<tt class="docutils literal"><span class="pre">LAST_UPDATED</span></tt>, <tt class="docutils literal"><span class="pre">DATE_CREATED</span></tt>, <tt class="docutils literal"><span class="pre">ETAG</span></tt>)
are included in response payloads. Overrides
<tt class="docutils literal"><span class="pre">EXTRA_RESPONSE_FIELDS</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">hateoas</span></tt></td>
<td>When <tt class="docutils literal"><span class="pre">False</span></tt>, this option disables
<a class="reference internal" href="features.html#hateoas-feature"><em>HATEOAS</em></a> for the resource.
Defaults to <tt class="docutils literal"><span class="pre">True</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">mongo_write_concern</span></tt></td>
<td><p class="first">A dictionary defining MongoDB write concern
settings for the endpoint datasource. All
standard write concern settings (w, wtimeout, j,
fsync) are supported. Defaults to <tt class="docutils literal"><span class="pre">{'w':</span> <span class="pre">1}</span></tt>
which means &#8216;do regular acknowledged writes&#8217;
(this is also the Mongo default.)</p>
<p class="last">Please be aware that setting &#8216;w&#8217; to a value of
2 or greater requires replication to be active
or you will be getting 500 errors (the write
will still happen; Mongo will just be unable
to check that it&#8217;s being written to multiple
servers.)</p>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">authentication</span></tt></td>
<td>A class with the authorization logic for the
endpoint. If not provided the eventual
general purpose auth class (passed as
application constructor argument) will be used.
For details on authentication and authorization
see <a class="reference internal" href="authentication.html#auth"><em>Authentication and Authorization</em></a>.  Defaults to <tt class="docutils literal"><span class="pre">None</span></tt>,</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">embedded_fields</span></tt></td>
<td>A list of fields for which <a class="reference internal" href="features.html#embedded-docs"><em>Embedded Resource Serialization</em></a>
is enabled by default. For this feature to work
properly fields in the list must be
<tt class="docutils literal"><span class="pre">embeddable</span></tt>, and <tt class="docutils literal"><span class="pre">embedding</span></tt> must be
active for the resource.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">query_objectid_as_string</span></tt></td>
<td>When enabled the Mongo parser will avoid
automatically casting electable strings to
ObjectIds. This can be useful in those rare
occurrences where you have string fields in the
database whose values can actually be casted to
ObjectId values, but shouldn&#8217;t. Only effects
queries (<tt class="docutils literal"><span class="pre">?where=</span></tt>). Defaults to <tt class="docutils literal"><span class="pre">False</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">schema</span></tt></td>
<td>A dict defining the actual data structure being
handled by the resource. Enables data
validation. See <a class="reference internal" href="#schema-definition">Schema Definition</a>.</td>
</tr>
</tbody>
</table>
<p>Here&#8217;s an example of resource customization, mostly done by overriding global
API settings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">people</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c"># &#39;title&#39; tag used in item links. Defaults to the resource title minus</span>
    <span class="c"># the final, plural &#39;s&#39; (works fine in most cases but not for &#39;people&#39;)</span>
    <span class="s">&#39;item_title&#39;</span><span class="p">:</span> <span class="s">&#39;person&#39;</span><span class="p">,</span>

    <span class="c"># by default, the standard item entry point is defined as</span>
    <span class="c"># &#39;/people/&lt;ObjectId&gt;/&#39;. We leave it untouched, and we also enable an</span>
    <span class="c"># additional read-only entry point. This way consumers can also perform</span>
    <span class="c"># GET requests at &#39;/people/&lt;lastname&gt;&#39;.</span>
    <span class="s">&#39;additional_lookup&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;url&#39;</span><span class="p">:</span> <span class="s">&#39;regex(&quot;[\w]+&quot;)&#39;</span><span class="p">,</span>
        <span class="s">&#39;field&#39;</span><span class="p">:</span> <span class="s">&#39;lastname&#39;</span>
    <span class="p">},</span>

    <span class="c"># We choose to override global cache-control directives for this resource.</span>
    <span class="s">&#39;cache_control&#39;</span><span class="p">:</span> <span class="s">&#39;max-age=10,must-revalidate&#39;</span><span class="p">,</span>
    <span class="s">&#39;cache_expires&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>

    <span class="c"># we only allow GET and POST at this resource endpoint.</span>
    <span class="s">&#39;resource_methods&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;POST&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="schema-definition">
<span id="schema"></span><h2>Schema Definition<a class="headerlink" href="#schema-definition" title="Permalink to this headline">¶</a></h2>
<p>Unless your API is read-only, you probably want to define resource <cite>schemas</cite>.
Schemas are important because they enable proper validation for incoming
streams.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># &#39;people&#39; schema definition</span>
<span class="s">&#39;schema&#39;</span><span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;firstname&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;string&#39;</span><span class="p">,</span>
        <span class="s">&#39;minlength&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">&#39;maxlength&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s">&#39;lastname&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;string&#39;</span><span class="p">,</span>
        <span class="s">&#39;minlength&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">&#39;maxlength&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
        <span class="s">&#39;required&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="s">&#39;unique&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="c"># &#39;role&#39; is a list, and can only contain values from &#39;allowed&#39;.</span>
    <span class="s">&#39;role&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;list&#39;</span><span class="p">,</span>
        <span class="s">&#39;allowed&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;author&quot;</span><span class="p">,</span> <span class="s">&quot;contributor&quot;</span><span class="p">,</span> <span class="s">&quot;copy&quot;</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="c"># An embedded &#39;strongly-typed&#39; dictionary.</span>
    <span class="s">&#39;location&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;dict&#39;</span><span class="p">,</span>
        <span class="s">&#39;schema&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&#39;address&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;string&#39;</span><span class="p">},</span>
            <span class="s">&#39;city&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;string&#39;</span><span class="p">}</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s">&#39;born&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;datetime&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As you can see, schema keys are the actual field names, while values are dicts
defining the field validation rules. Allowed validation rules are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">type</span></tt></td>
<td>Field data type. Can be one of the following:
<tt class="docutils literal"><span class="pre">string</span></tt>, <tt class="docutils literal"><span class="pre">integer</span></tt>, <tt class="docutils literal"><span class="pre">boolean</span></tt>,
<tt class="docutils literal"><span class="pre">float</span></tt>, <tt class="docutils literal"><span class="pre">datetime</span></tt>, <tt class="docutils literal"><span class="pre">dict</span></tt>, <tt class="docutils literal"><span class="pre">list</span></tt>,
<tt class="docutils literal"><span class="pre">objectid</span></tt>, <tt class="docutils literal"><span class="pre">file</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">required</span></tt></td>
<td>If <tt class="docutils literal"><span class="pre">True</span></tt>, the field is mandatory on
insertion.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">readonly</span></tt></td>
<td>If <tt class="docutils literal"><span class="pre">True</span></tt>, the field is readonly.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">minlength</span></tt>, <tt class="docutils literal"><span class="pre">maxlength</span></tt></td>
<td>Minimum and maximum length allowed for
<tt class="docutils literal"><span class="pre">string</span></tt> and <tt class="docutils literal"><span class="pre">list</span></tt> types.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">min</span></tt>, <tt class="docutils literal"><span class="pre">max</span></tt></td>
<td>Minimum and maximum values allowed for
<tt class="docutils literal"><span class="pre">integer</span></tt> types.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">allowed</span></tt></td>
<td>List of allowed values for <tt class="docutils literal"><span class="pre">string</span></tt> and
<tt class="docutils literal"><span class="pre">list</span></tt> types.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">empty</span></tt></td>
<td>Only applies to string fields. If <tt class="docutils literal"><span class="pre">False</span></tt>,
validation will fail if the value is empty.
Defaults to <tt class="docutils literal"><span class="pre">True</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">items</span></tt></td>
<td>Defines a list of values allowed in a <tt class="docutils literal"><span class="pre">list</span></tt>
of fixed length.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">schema</span></tt></td>
<td>Validation schema for <tt class="docutils literal"><span class="pre">dict</span></tt> types and
arbitrary length <tt class="docutils literal"><span class="pre">list</span></tt> types. For details
and usage examples, see <a class="reference external" href="http://cerberus.readthedocs.org/en/latest/index.html#schema" title="(in Cerberus v0.5)"><em class="xref std std-ref">Cerberus documentation</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">unique</span></tt></td>
<td><p class="first">The value of the field must be unique within
the collection.</p>
<p>Please note: validation constraints are checked
against the database, and not between the
payload documents themselves. This causes an
interesting corner case: in the event of
a multiple documents payload where two or more
documents carry the same value for a field
where the &#8216;unique&#8217; constraint is set, the
payload will validate successfully, as there
are no duplicates in the database (yet).</p>
<p class="last">If this is an issue, the client can always send
the documents one at a time for insertion, or
validate locally before submitting the payload
to the API.</p>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">data_relation</span></tt></td>
<td><p class="first">Allows to specify a referential integrity rule
that the value must satisfy in order to
validate. It is a dict with three keys:</p>
<ul class="last simple">
<li><tt class="docutils literal"><span class="pre">resource</span></tt>: the name of the resource being referenced;</li>
<li><tt class="docutils literal"><span class="pre">field</span></tt>: the field name in the foreign resource;</li>
<li><tt class="docutils literal"><span class="pre">embeddable</span></tt>: set to <tt class="docutils literal"><span class="pre">True</span></tt> if clients can request the referenced document to be embedded with the serialization. See <a class="reference internal" href="features.html#embedded-docs"><em>Embedded Resource Serialization</em></a>. Defaults to <tt class="docutils literal"><span class="pre">False</span></tt>.</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">nullable</span></tt></td>
<td>If <tt class="docutils literal"><span class="pre">True</span></tt> the field value can be set to
<tt class="docutils literal"><span class="pre">None</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">default</span></tt></td>
<td>The default value for the field. When serving
POST (create) requests, missing fields will be
assigned the configured default values.</td>
</tr>
</tbody>
</table>
<p>Schema syntax is based on <a class="reference external" href="http://cerberus.readthedocs.org">Cerberus</a> and yes, it can be extended.  In fact, Eve
itself extends the original grammar by adding the <tt class="docutils literal"><span class="pre">unique</span></tt> and
<tt class="docutils literal"><span class="pre">data_relation</span></tt> keywords, along with the <tt class="docutils literal"><span class="pre">objectid</span></tt> datatype. For more
information on custom validation and usage examples see <a class="reference internal" href="validation.html#validation"><em>Data Validation</em></a>.</p>
<p>In <a class="reference internal" href="#local"><em>Resource / Item Endpoints</em></a> you customized the <cite>people</cite> endpoint. Then, in this section,
you defined <cite>people</cite> validation rules. Now you are ready to update the domain
which was originally set up in <a class="reference internal" href="#domain-configuration">Domain Configuration</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># add the schema to the &#39;people&#39; resource definition</span>
<span class="n">people</span><span class="p">[</span><span class="s">&#39;schema&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">schema</span>
<span class="c"># update the domain</span>
<span class="n">DOMAIN</span><span class="p">[</span><span class="s">&#39;people&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">people</span>
</pre></div>
</div>
</div>
<div class="section" id="advanced-datasource-patterns">
<span id="datasource"></span><h2>Advanced Datasource Patterns<a class="headerlink" href="#advanced-datasource-patterns" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">datasource</span></tt> keyword allows to explicitly link API resources to database
collections. If omitted, the domain resource key is assumed to also be the name
of the database collection. It is a dictionary with four allowed keys:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">source</span></tt></td>
<td>Name of the database collection consumed by the
resource.  If omitted, the resource name is
assumed to also be a valid collection name. See
<a class="reference internal" href="#source"><em>Multiple API Endpoints, One Datasource</em></a>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">filter</span></tt></td>
<td>Database query used to retrieve and validate
data. If omitted, by default the whole
collection is retrievied. See <a class="reference internal" href="#filter"><em>Predefined Database Filters</em></a>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">projection</span></tt></td>
<td>Fieldset exposed by the endpoint. If omitted,
by default all fields will be returned to the
client. See <a class="reference internal" href="#projection"><em>Limiting the Fieldset Exposed by the API Endpoint</em></a>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">default_sort</span></tt></td>
<td><p class="first">Default sorting for documents retrieved at the
endpoint. If omitted, documents will be
returned with the default database order.
A valid statement would be:</p>
<p><tt class="docutils literal"><span class="pre">'datasource':</span> <span class="pre">{'default_sort':</span> <span class="pre">[('name':</span>
<span class="pre">1)]}</span></tt></p>
<p class="last">For more informations on sort and filters see
<a class="reference internal" href="features.html#filters"><em>Filtering and Sorting</em></a>.</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="predefined-database-filters">
<span id="filter"></span><h3>Predefined Database Filters<a class="headerlink" href="#predefined-database-filters" title="Permalink to this headline">¶</a></h3>
<p>Database filters for the API endpoint are set with the <tt class="docutils literal"><span class="pre">filter</span></tt> keyword.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">people</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;datasource&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;filter&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;username&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;$exists&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>In the example above, the API endpoint for the <cite>people</cite> resource will only
expose and update documents with an existing <cite>username</cite> field.</p>
<p>Predefined filters run on top of user queries (GET requests with <cite>where</cite>
clauses) and standard conditional requests (<cite>If-Modified-Since</cite>, etc.)</p>
<p>Please note that datasource filters are applied on GET, PATCH and DELETE
requests. If your resource allows POST requests (document insertions),
then you will probably want to set the validation rules accordingly (in our
example, &#8216;username&#8217; should probably be a required field).</p>
</div>
<div class="section" id="multiple-api-endpoints-one-datasource">
<span id="source"></span><h3>Multiple API Endpoints, One Datasource<a class="headerlink" href="#multiple-api-endpoints-one-datasource" title="Permalink to this headline">¶</a></h3>
<p>Multiple API endpoints can target the same database collection. For
example you can set both <tt class="docutils literal"><span class="pre">/admins</span></tt> and <tt class="docutils literal"><span class="pre">/users</span></tt> to read and write from
the same <cite>people</cite> collection on the database.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">people</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;datasource&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;source&#39;</span><span class="p">:</span> <span class="s">&#39;people&#39;</span><span class="p">,</span>
        <span class="s">&#39;filter&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;userlevel&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>The above setting will retrieve, edit and delete only documents from the
<cite>people</cite> collection with a <cite>userlevel</cite> of 1.</p>
</div>
<div class="section" id="limiting-the-fieldset-exposed-by-the-api-endpoint">
<span id="projection"></span><h3>Limiting the Fieldset Exposed by the API Endpoint<a class="headerlink" href="#limiting-the-fieldset-exposed-by-the-api-endpoint" title="Permalink to this headline">¶</a></h3>
<p>By default API responses to GET requests will include all fields defined by the
corresponding resource <a class="reference internal" href="#schema">schema</a>. The <tt class="docutils literal"><span class="pre">projection</span></tt> setting of the <cite>datasource</cite>
resource keyword allows you to redefine the fieldset.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">people</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;datasource&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;projection&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;username&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>The above setting will expose only the <cite>username</cite> field to GET requests, no
matter the <a class="reference internal" href="#schema">schema</a> defined for the resource.</p>
<p>Likewise, you can esclude fields from API responses:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">people</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;datasource&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;projection&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;username&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>The above will include all document fields but <cite>username</cite>.</p>
<p>Please note that POST and PATCH methods will still allow the whole schema to be
manipulated. This feature can come in handy when, for example, you want to
protect insertion and modification behind an <a class="reference internal" href="authentication.html#auth"><em>Authentication and Authorization</em></a> scheme while leaving
read access open to the public.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><p class="logo">
  <a href="index.html">
      <img class="logo" src="_static/eve-sidebar.png" alt="Logo"/>
  </a>
</p>
<p>
  <iframe src="http://ghbtns.com/github-btn.html?user=nicolaiarocci&repo=eve&type=watch&count=true&size=large"
    allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p> 
<!--<h3>About Eve</h3>-->
<p>
  You are looking at the documentation of the development version.
</p>
<h3>Support Eve</h3>
<p>If your organization uses Eve, consider financial support:</p>
<p>
<a href="https://gum.co/EhzI" class="gumroad-button">Eve Pro</a> <script type="text/javascript" src="https://gumroad.com/js/gumroad.js"></script>
</p>
<h3>Get Updates</h3>
<p>Receive updates on new releases and upcoming projects.</p>
<p>
<a href="http://tinyletter.com/nicolaiarocci">Subscribe to Newsletter</a>
</p>
<h3>Useful Links</h3>
<ul>
  <li><a href="http://stackoverflow.com/questions/tagged/eve">Stack Overflow</a></li>
  <li><a href="https://groups.google.com/forum/#!forum/python-eve">Mailing List</a></li>
  <li><a href="http://github.com/nicolaiarocci/eve/issues">Issue Tracker</a></li>
  <li><a href="http://github.com/nicolaiarocci/eve">GitHub</a></li>
  <li><a href="http://blog.python-eve.org/">Blog</a></li>
  <li><a href="http://github.com/nicolaiarocci/eve-demo">Demo</a></li>
  <li><a href="irc://irc.freenode.net/python-eve">IRC</a>
</ul>
<h3>Feedback</h3>
<p>
  Feedback is greatly appreciated. If you have any questions, comments,
  random praise, or anonymous threats, get on the <a href="https://groups.google.com/forum/#!forum/python-eve">mailing list</a> or <a href="mailto:eve@nicolaiarocci.com">
  shoot an email</a>.
</p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Configuration Handling</a><ul>
<li><a class="reference internal" href="#configuration-with-files">Configuration with Files</a></li>
<li><a class="reference internal" href="#configuration-with-a-dictionary">Configuration with a Dictionary</a></li>
<li><a class="reference internal" href="#development-production">Development / Production</a></li>
<li><a class="reference internal" href="#global-configuration">Global Configuration</a></li>
<li><a class="reference internal" href="#domain-configuration">Domain Configuration</a><ul>
<li><a class="reference internal" href="#resource-item-endpoints">Resource / Item Endpoints</a></li>
</ul>
</li>
<li><a class="reference internal" href="#schema-definition">Schema Definition</a></li>
<li><a class="reference internal" href="#advanced-datasource-patterns">Advanced Datasource Patterns</a><ul>
<li><a class="reference internal" href="#predefined-database-filters">Predefined Database Filters</a></li>
<li><a class="reference internal" href="#multiple-api-endpoints-one-datasource">Multiple API Endpoints, One Datasource</a></li>
<li><a class="reference internal" href="#limiting-the-fieldset-exposed-by-the-api-endpoint">Limiting the Fieldset Exposed by the API Endpoint</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="features.html" title="previous chapter">Features</a></li>
      <li>Next: <a href="validation.html" title="next chapter">Data Validation</a></li>
  </ul></li>
</ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2014. A <a href="http://nicolaiarocci.com">Nicola Iarocci</a> Project.
  </div>
  <a href="https://github.com/nicolaiarocci/eve" class="github">
      <img style="position: absolute; top: 0; right: 0; border: 0;" src="_static/forkme_right_green_007200.png" alt="Fork me on GitHub"  class="github"/>
  </a>
  
  </body>
</html>