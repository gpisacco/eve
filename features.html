
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Features &mdash; Eve 0.3-dev documentation</title>
    
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.3-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="Eve 0.3-dev documentation" href="index.html" />
    <link rel="next" title="Configuration Handling" href="config.html" />
    <link rel="prev" title="Quickstart" href="quickstart.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body>
  
  

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="config.html" title="Configuration Handling"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="quickstart.html" title="Quickstart"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Eve 0.3-dev documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="features">
<h1>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h1>
<p>Below is a list of main features that any EVE-powered APIs can expose. Most of
these features can be experienced live by consuming the Demo API (see
<a class="reference internal" href="index.html#demo"><em>Live demo</em></a>).</p>
<div class="section" id="emphasis-on-rest">
<h2>Emphasis on REST<a class="headerlink" href="#emphasis-on-rest" title="Permalink to this headline">¶</a></h2>
<p>The Eve project aims to provide the best possible REST-compliant API
implementation. Fundamental <a class="reference external" href="http://en.wikipedia.org/wiki/Representational_state_transfer">REST</a> principles like <em>separation of concerns</em>,
<em>stateless and layered system</em>, <em>cacheability</em>, <em>uniform interface</em> have been
kept into consideration while designing the core API.</p>
</div>
<div class="section" id="full-range-of-crud-operations">
<h2>Full range of CRUD operations<a class="headerlink" href="#full-range-of-crud-operations" title="Permalink to this headline">¶</a></h2>
<p>APIs can support the full range of <a class="reference external" href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> operations. Within the same API, you
can have a read-only resource accessible at one endpoint, along with a fully
editable resource at another endpoint. The following table shows Eve&#8217;s
implementation of CRUD via REST:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="26%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">HTTP Verb</th>
<th class="head">Context</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Create</td>
<td>POST</td>
<td>Collection</td>
</tr>
<tr class="row-odd"><td>Read</td>
<td>GET, HEAD</td>
<td>Collection/Document</td>
</tr>
<tr class="row-even"><td>Update</td>
<td>PATCH</td>
<td>Document</td>
</tr>
<tr class="row-odd"><td>Replace</td>
<td>PUT</td>
<td>Document</td>
</tr>
<tr class="row-even"><td>Delete</td>
<td>DELETE</td>
<td>Collection/Document</td>
</tr>
</tbody>
</table>
<div class="section" id="overriding-http-methods">
<h3>Overriding HTTP Methods<a class="headerlink" href="#overriding-http-methods" title="Permalink to this headline">¶</a></h3>
<p>As a fallback for the odd client not supporting any of these methods, the API
will gladly honor <tt class="docutils literal"><span class="pre">X-HTTP-Method-Override</span></tt> requests. For example a client not
supporting the <tt class="docutils literal"><span class="pre">PATCH</span></tt> method could send a <tt class="docutils literal"><span class="pre">POST</span></tt> request with
a <tt class="docutils literal"><span class="pre">X-HTTP-Method-Override:</span> <span class="pre">PATCH</span></tt> header.  The API would then perform
a <tt class="docutils literal"><span class="pre">PATCH</span></tt>, overriding the original request method.</p>
</div>
</div>
<div class="section" id="customizable-resource-endpoints">
<span id="resource-endpoints"></span><h2>Customizable resource endpoints<a class="headerlink" href="#customizable-resource-endpoints" title="Permalink to this headline">¶</a></h2>
<p>By default, Eve will make known database collections available as resource
endpoints (persistent identifiers in REST idiom). So a database <tt class="docutils literal"><span class="pre">people</span></tt>
collection will be avaliable at the <tt class="docutils literal"><span class="pre">example.com/people</span></tt> API endpoint.  You
can customize the URIs though, so the API endpoint could become, say,
<tt class="docutils literal"><span class="pre">example.com/customers/overseas</span></tt>. Consider the following request:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://eve-demo.herokuapp.com/people
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>The response payload will look something like this:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;_items&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;firstname&quot;</span><span class="o">:</span> <span class="s2">&quot;Mark&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lastname&quot;</span><span class="o">:</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span>
            <span class="s2">&quot;born&quot;</span><span class="o">:</span> <span class="s2">&quot;Sat, 23 Feb 1985 12:00:00 GMT&quot;</span><span class="p">,</span>
            <span class="s2">&quot;role&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">,</span> <span class="s2">&quot;author&quot;</span><span class="p">],</span>
            <span class="s2">&quot;location&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;city&quot;</span><span class="o">:</span> <span class="s2">&quot;New York&quot;</span><span class="p">,</span> <span class="s2">&quot;address&quot;</span><span class="o">:</span> <span class="s2">&quot;4925 Lacross Road&quot;</span><span class="p">},</span>
            <span class="s2">&quot;_id&quot;</span><span class="o">:</span> <span class="s2">&quot;50bf198338345b1c604faf31&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_updated&quot;</span><span class="o">:</span> <span class="s2">&quot;Wed, 05 Dec 2012 09:53:07 GMT&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_created&quot;</span><span class="o">:</span> <span class="s2">&quot;Wed, 05 Dec 2012 09:53:07 GMT&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_etag&quot;</span><span class="o">:</span> <span class="s2">&quot;ec5e8200b8fa0596afe9ca71a87f23e71ca30e2d&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_links&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;self&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;href&quot;</span><span class="o">:</span> <span class="s2">&quot;eve-demo.herokuapp.com:5000/people/50bf198338345b1c604faf31&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;person&quot;</span><span class="p">},</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="p">...</span>
    <span class="p">],</span>
    <span class="s2">&quot;_links&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;self&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;href&quot;</span><span class="o">:</span> <span class="s2">&quot;eve-demo.herokuapp.com:5000/people&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;people&quot;</span><span class="p">},</span>
        <span class="s2">&quot;parent&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;href&quot;</span><span class="o">:</span> <span class="s2">&quot;eve-demo.herokuapp.com:5000&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;home&quot;</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">_items</span></tt> list contains the requested data. Along with its own fields,
each item provides some important, additional fields:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">_created</span></tt></td>
<td>item creation date.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">_updated</span></tt></td>
<td>item last updated on.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">_etag</span></tt></td>
<td>ETag, to be used for concurrency control and conditional requests.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">_id</span></tt></td>
<td>unique item key, also needed to access the individual item endpoint.</td>
</tr>
</tbody>
</table>
<p>These additional fields are automatically handled by the API (clients don&#8217;t
need to provide them when adding/editing resources).</p>
<p>The <tt class="docutils literal"><span class="pre">_links</span></tt> list provides <a class="reference external" href="http://en.wikipedia.org/wiki/HATEOAS">HATEOAS</a> directives.</p>
<div class="section" id="sub-resources">
<span id="subresources"></span><h3>Sub Resources<a class="headerlink" href="#sub-resources" title="Permalink to this headline">¶</a></h3>
<p>Endpoints support sub-resources so you could have something like:
<tt class="docutils literal"><span class="pre">/people/&lt;contact_id&gt;/invoices</span></tt>. When setting the <tt class="docutils literal"><span class="pre">url</span></tt> rule for such and
endpoint you would use a regex and assign a field name to it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">invoices</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;url&#39;</span><span class="p">:</span> <span class="s">&#39;people/&lt;regex(&quot;[a-f0-9]{24}&quot;):contact_id&gt;/invoices&#39;</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Then this GET to the endpoint, which would roughly translate to <em>give
me all the invoices by &lt;contact_id&gt;</em>:</p>
<div class="highlight-python"><pre>people/51f63e0838345b6dcd7eabff/invoices</pre>
</div>
<p>Would cause the underlying database collection invoices to be queried this way:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&#39;contact_id&#39;</span><span class="p">:</span> <span class="s">&#39;51f63e0838345b6dcd7eabff&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>And this one:</p>
<div class="highlight-python"><pre>people/51f63e0838345b6dcd7eabff/invoices?where={"number": 10}</pre>
</div>
<p>would be queried like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&#39;contact_id&#39;</span><span class="p">:</span> <span class="s">&#39;51f63e0838345b6dcd7eabff&#39;</span><span class="p">,</span> <span class="s">&quot;number&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
</pre></div>
</div>
<p>Please note that when designing your API, most of the time you can get away
without resorting to sub-resources. In the example above the same result would
be achieved by simply exposing a <tt class="docutils literal"><span class="pre">invoices</span></tt> endpoint that clients could query
this way:</p>
<div class="highlight-python"><pre>invoices?where={"contact_id": 51f63e0838345b6dcd7eabff}</pre>
</div>
<p>or</p>
<div class="highlight-python"><pre>invoices?where={"contact_id": 51f63e0838345b6dcd7eabff, "number": 10}</pre>
</div>
<p>It&#8217;s mostly a design choice, but keep in mind that when it comes to enabling
individual documment endpoints you might occur in performance hits. This
otherwise legit GET request:</p>
<div class="highlight-python"><pre>people/&lt;contact_id&gt;/invoices/&lt;invoice_id&gt;</pre>
</div>
<p>would cause a two fields lookup on the database. This is not ideal and also not
really needed, as <tt class="docutils literal"><span class="pre">&lt;invoice_id&gt;</span></tt> is a unique field. By contrast, if you had
a simple resource endpoint the document lookup would happen on a single field:</p>
<div class="highlight-python"><pre>invoices/&lt;invoice_id&gt;</pre>
</div>
</div>
</div>
<div class="section" id="customizable-multiple-item-endpoints">
<span id="custom-item-endpoints"></span><h2>Customizable, multiple item endpoints<a class="headerlink" href="#customizable-multiple-item-endpoints" title="Permalink to this headline">¶</a></h2>
<p>Resources can or cannot expose individual item endpoints. API consumers could
get access to <tt class="docutils literal"><span class="pre">/people</span></tt>, <tt class="docutils literal"><span class="pre">/people/&lt;ObjectId&gt;</span></tt> and <tt class="docutils literal"><span class="pre">/people/Doe</span></tt>,
but only to <tt class="docutils literal"><span class="pre">/works</span></tt>.  When you do grant access to item endpoints, you can
define up to two lookups, both defined with regexes. The first will be the
primary endpoint and will match your database primary key structure (i.e., an
<tt class="docutils literal"><span class="pre">ObjectId</span></tt> in a MongoDB database).</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://eve-demo.herokuapp.com/people/521d6840c437dc0002d1203c
<span class="go">HTTP/1.1 200 OK</span>
<span class="go">Etag: 28995829ee85d69c4c18d597a0f68ae606a266cc</span>
<span class="go">Last-Modified: Wed, 21 Nov 2012 16:04:56 GMT</span>
<span class="go">...</span>
</pre></div>
</div>
<p>The second, which is optional and read-only, will match a field with unique values since Eve
will retrieve only the first match anyway.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://eve-demo.herokuapp.com/people/Doe
<span class="go">HTTP/1.1 200 OK</span>
<span class="go">Etag: 28995829ee85d69c4c18d597a0f68ae606a266cc</span>
<span class="go">Last-Modified: Wed, 21 Nov 2012 16:04:56 GMT</span>
<span class="go">...</span>
</pre></div>
</div>
<p>Since we are accessing the same item, in both cases the response payload will
look something like this:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;firstname&quot;</span><span class="o">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lastname&quot;</span><span class="o">:</span> <span class="s2">&quot;Doe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;born&quot;</span><span class="o">:</span> <span class="s2">&quot;Thu, 27 Aug 1970 14:37:13 GMT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;role&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">],</span>
    <span class="s2">&quot;location&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;city&quot;</span><span class="o">:</span> <span class="s2">&quot;Auburn&quot;</span><span class="p">,</span> <span class="s2">&quot;address&quot;</span><span class="o">:</span> <span class="s2">&quot;422 South Gay Street&quot;</span><span class="p">},</span>
    <span class="s2">&quot;_id&quot;</span><span class="o">:</span> <span class="s2">&quot;50acfba938345b0978fccad7&quot;</span>
    <span class="s2">&quot;_updated&quot;</span><span class="o">:</span> <span class="s2">&quot;Wed, 21 Nov 2012 16:04:56 GMT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_created&quot;</span><span class="o">:</span> <span class="s2">&quot;Wed, 21 Nov 2012 16:04:56 GMT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_etag&quot;</span><span class="o">:</span> <span class="s2">&quot;28995829ee85d69c4c18d597a0f68ae606a266cc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_links&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;self&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;href&quot;</span><span class="o">:</span> <span class="s2">&quot;eve-demo.herokuapp.com/people/50acfba938345b0978fccad7&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;person&quot;</span><span class="p">},</span>
        <span class="s2">&quot;parent&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;href&quot;</span><span class="o">:</span> <span class="s2">&quot;eve-demo.herokuapp.com&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;home&quot;</span><span class="p">},</span>
        <span class="s2">&quot;collection&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;href&quot;</span><span class="o">:</span> <span class="s2">&quot;http://eve-demo.herokuapp.com/people&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;people&quot;</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As you can see, item endpoints provide their own <a class="reference external" href="http://en.wikipedia.org/wiki/HATEOAS">HATEOAS</a> directives.</p>
<div class="admonition-please-note admonition">
<p class="first admonition-title">Please Note</p>
<p>According to REST principles resource items should only have one unique
identifier. Eve abides by providing one default endpoint per item. Adding
a secondary endpoint is a decision that should pondered carefully.</p>
<p class="last">Consider our example above. Even without the <tt class="docutils literal"><span class="pre">/people/&lt;lastname&gt;</span></tt>
endpoint, a client could always retrieve a person by querying the resource
endpoint by last name: <tt class="docutils literal"><span class="pre">/people/?where={&quot;lastname&quot;:</span> <span class="pre">&quot;Doe&quot;}</span></tt>. Actually the
whole example is fubar, as there could be multiple people sharing the same
last name, but you get the idea.</p>
</div>
</div>
<div class="section" id="filtering-and-sorting">
<span id="filters"></span><h2>Filtering and Sorting<a class="headerlink" href="#filtering-and-sorting" title="Permalink to this headline">¶</a></h2>
<p>Resource endpoints allow consumers to retrieve multiple documents. Query
strings are supported, allowing for filtering and sorting. Two query syntaxes
are supported. The mongo query syntax:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://eve-demo.herokuapp.com/people?where<span class="o">={</span><span class="s2">&quot;lastname&quot;</span>: <span class="s2">&quot;Doe&quot;</span><span class="o">}</span>
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>and the native Python syntax:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://eve-demo.herokuapp.com/people?where<span class="o">=</span><span class="nv">lastname</span><span class="o">==</span><span class="s2">&quot;Doe&quot;</span>
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>Both query formats allow for conditional and logical And/Or operators, however
nested and combined.</p>
<p>Filters are enabled by default on all document fields. However, the API
maintainer can choose to disable them all and/or whitelist allowed ones (see
<tt class="docutils literal"><span class="pre">ALLOWED_FILTERS</span></tt> in <a class="reference internal" href="config.html#global"><em>Global Configuration</em></a>). If scraping, or fear of DB DoS attacks
by querying on non-indexed fields is a concern, then whitelisting allowed
filters is the way to go.</p>
<p>Sorting is supported as well:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://eve-demo.herokuapp.com/people?sort<span class="o">=[(</span><span class="s2">&quot;lastname&quot;</span>, -1<span class="o">)]</span>
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>Sorting is enabled by default and can be disabled both globally and/or at
resource level (see <tt class="docutils literal"><span class="pre">SORTING</span></tt> in <a class="reference internal" href="config.html#global"><em>Global Configuration</em></a> and <tt class="docutils literal"><span class="pre">sorting</span></tt> in
<a class="reference internal" href="config.html#domain"><em>Domain Configuration</em></a>). It is also possible to set the default sort at every API
endpoints (see <tt class="docutils literal"><span class="pre">default_sort</span></tt> in <a class="reference internal" href="config.html#domain"><em>Domain Configuration</em></a>). Currently, sort directives
use a pure MongoDB syntax; support for a more general syntax
(<tt class="docutils literal"><span class="pre">sort=lastname</span></tt>) is planned.</p>
<div class="admonition-please-note admonition">
<p class="first admonition-title">Please note</p>
<p class="last">Always use double quotes to wrap field names and values. Using single
quotes will result in <tt class="docutils literal"><span class="pre">400</span> <span class="pre">Bad</span> <span class="pre">Request</span></tt> responses.</p>
</div>
</div>
<div class="section" id="pagination">
<h2>Pagination<a class="headerlink" href="#pagination" title="Permalink to this headline">¶</a></h2>
<p>Resource pagination is enabled by default in order to improve performance and
preserve bandwidth. When a consumer requests a resource, the first N items
matching the query are served, and links to subsequent/previous pages are
provided with the response. Default and maximum page size is customizable, and
consumers can request specific pages via the query string:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://eve-demo.herokuapp.com/people?max_results<span class="o">=</span>20&amp;page<span class="o">=</span>2
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>Of course you can mix all the available query parameters:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://eve-demo.herokuapp.com/people?where<span class="o">={</span><span class="s2">&quot;lastname&quot;</span>: <span class="s2">&quot;Doe&quot;</span><span class="o">}</span>&amp;sort<span class="o">=[(</span><span class="s2">&quot;firstname&quot;</span>, 1<span class="o">)]</span>&amp;page<span class="o">=</span>5
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>Pagination can be disabled.</p>
</div>
<div class="section" id="hateoas">
<span id="hateoas-feature"></span><h2>HATEOAS<a class="headerlink" href="#hateoas" title="Permalink to this headline">¶</a></h2>
<p><em>Hypermedia as the Engine of Application State</em> (<a class="reference external" href="http://en.wikipedia.org/wiki/HATEOAS">HATEOAS</a>) is enabled by
default. Each GET response includes a <tt class="docutils literal"><span class="pre">_links</span></tt> section. Links provide details
on their <tt class="docutils literal"><span class="pre">relation</span></tt> relative to the resource being accessed, and a <tt class="docutils literal"><span class="pre">title</span></tt>.
Relations and titles can then be used by clients to dynamically updated their
UI, or to navigate the API without knowing its structure beforehand. An example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;_links&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;self&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;href&quot;</span><span class="p">:</span> <span class="s">&quot;localhost:5000/people&quot;</span><span class="p">,</span>
            <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="s">&quot;people&quot;</span>
        <span class="p">},</span>
        <span class="s">&quot;parent&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;href&quot;</span><span class="p">:</span> <span class="s">&quot;localhost:5000&quot;</span><span class="p">,</span>
            <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="s">&quot;home&quot;</span>
        <span class="p">},</span>
        <span class="s">&quot;next&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;href&quot;</span><span class="p">:</span> <span class="s">&quot;localhost:5000/people?page=2&quot;</span><span class="p">,</span>
            <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="s">&quot;next page&quot;</span>
        <span class="p">},</span>
        <span class="s">&quot;last&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;href&quot;</span><span class="p">:</span> <span class="s">&quot;localhost:5000/people?page=10&quot;</span><span class="p">,</span>
            <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="s">&quot;last page&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A GET request to the API home page (the API entry point) will be served with
a list of links to accessible resources. From there, any client could navigate
the API just by following the links provided with every response.</p>
<p>Please note that <tt class="docutils literal"><span class="pre">next</span></tt>, <tt class="docutils literal"><span class="pre">previous</span></tt> and <tt class="docutils literal"><span class="pre">last</span></tt> items will only be
included when appropriate.</p>
<div class="section" id="disabling-hateoas">
<h3>Disabling HATEOAS<a class="headerlink" href="#disabling-hateoas" title="Permalink to this headline">¶</a></h3>
<p>HATEOAS can be disabled both at the API and/or resource level. When HATEOAS is
disabled, response payloads have a different structure. The resource payload is
a simple list of items:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://eve-demo.herokuapp.com/people
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;firstname&quot;</span><span class="o">:</span> <span class="s2">&quot;Mark&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lastname&quot;</span><span class="o">:</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span>
        <span class="s2">&quot;born&quot;</span><span class="o">:</span> <span class="s2">&quot;Sat, 23 Feb 1985 12:00:00 GMT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;role&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">,</span> <span class="s2">&quot;author&quot;</span><span class="p">],</span>
        <span class="s2">&quot;location&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;city&quot;</span><span class="o">:</span> <span class="s2">&quot;New York&quot;</span><span class="p">,</span> <span class="s2">&quot;address&quot;</span><span class="o">:</span> <span class="s2">&quot;4925 Lacross Road&quot;</span><span class="p">},</span>
        <span class="s2">&quot;_id&quot;</span><span class="o">:</span> <span class="s2">&quot;50bf198338345b1c604faf31&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_updated&quot;</span><span class="o">:</span> <span class="s2">&quot;Wed, 05 Dec 2012 09:53:07 GMT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_created&quot;</span><span class="o">:</span> <span class="s2">&quot;Wed, 05 Dec 2012 09:53:07 GMT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_etag&quot;</span><span class="o">:</span> <span class="s2">&quot;ec5e8200b8fa0596afe9ca71a87f23e71ca30e2d&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;firstname&quot;</span><span class="o">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
        <span class="p">...</span>
    <span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
<p>As you can see, the <tt class="docutils literal"><span class="pre">_links</span></tt> element is also missing from list items. The
same happens to individual item payloads:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://eve-demo.herokuapp.com/people/522f01dc15b4fc00028e6d98
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;lastname&quot;</span><span class="o">:</span> <span class="s2">&quot;obama&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_id&quot;</span><span class="o">:</span> <span class="s2">&quot;522f01dc15b4fc00028e6d98&quot;</span><span class="p">,</span>
    <span class="s2">&quot;firstname&quot;</span><span class="o">:</span> <span class="s2">&quot;barack&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_created&quot;</span><span class="o">:</span> <span class="s2">&quot;Tue, 10 Sep 2013 11:26:20 GMT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_etag&quot;</span><span class="o">:</span> <span class="s2">&quot;206fb4a39815cc0ebf48b2b52d709777a55333de&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_updated&quot;</span><span class="o">:</span> <span class="s2">&quot;Tue, 10 Sep 2013 11:26:20 GMT&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Why would you want to turn HATEOAS off? Well, if you know that your client
application is not going to use the feature, then you might want to save on
both bandwidth and performance. Also, some REST client libraries out there
might have issues when parsing something other than a simple list of items.</p>
<div class="admonition-please-note admonition">
<p class="first admonition-title">Please note</p>
<p class="last">When HATEOAS is disabled, the API entry point (the home page) will return
a <tt class="docutils literal"><span class="pre">404</span> <span class="pre">Not</span> <span class="pre">Found</span></tt>, since its only usefulness would be to return a list of
available resources, which is the standard behavior when HATEOAS is
enabled.</p>
</div>
</div>
</div>
<div class="section" id="json-and-xml-rendering">
<span id="jsonxml"></span><h2>JSON and XML Rendering<a class="headerlink" href="#json-and-xml-rendering" title="Permalink to this headline">¶</a></h2>
<p>Eve responses are automatically rendered as JSON (the default) or XML,
depending on the request <tt class="docutils literal"><span class="pre">Accept</span></tt> header. Inbound documents (for inserts and
edits) are in JSON format.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -H <span class="s2">&quot;Accept: application/xml&quot;</span> -i http://eve-demo.herokuapp.com
<span class="go">HTTP/1.1 200 OK</span>
<span class="go">Content-Type: application/xml; charset=utf-8</span>
<span class="go">...</span>
</pre></div>
</div>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;resource&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;child&quot;</span> <span class="na">href=</span><span class="s">&quot;eve-demo.herokuapp.com/people&quot;</span> <span class="na">title=</span><span class="s">&quot;people&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;child&quot;</span> <span class="na">href=</span><span class="s">&quot;eve-demo.herokuapp.com/works&quot;</span> <span class="na">title=</span><span class="s">&quot;works&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/resource&gt;</span>
</pre></div>
</div>
<p>XML support can be disabled by setting <tt class="docutils literal"><span class="pre">XML</span></tt> to <tt class="docutils literal"><span class="pre">False</span></tt> in the settings
file. JSON support can be disabled by setting <tt class="docutils literal"><span class="pre">JSON</span></tt> to <tt class="docutils literal"><span class="pre">False</span></tt>.  Please
note that at least one mime type must always be enabled, either implicitly or
explicitly. By default, both are supported.</p>
</div>
<div class="section" id="conditional-requests">
<span id="id1"></span><h2>Conditional Requests<a class="headerlink" href="#conditional-requests" title="Permalink to this headline">¶</a></h2>
<p>Each resource representation provides information on the last time it was
updated (<tt class="docutils literal"><span class="pre">Last-Modified</span></tt>), along with an hash value computed on the
representation itself (<tt class="docutils literal"><span class="pre">ETag</span></tt>). These headers allow clients to perform
conditional requests, only retrieving new or modified data, by using the
<tt class="docutils literal"><span class="pre">If-Modified-Since</span></tt> header:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -H <span class="s2">&quot;If-Modified-Since: Wed, 05 Dec 2012 09:53:07 GMT&quot;</span> -i http://eve-demo.herokuapp.com/people
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>or the <tt class="docutils literal"><span class="pre">If-None-Match</span></tt> header:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -H <span class="s2">&quot;If-None-Match: 1234567890123456789012345678901234567890&quot;</span> -i http://eve-demo.herokuapp.com/people
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
</div>
<div class="section" id="data-integrity-and-concurrency-control">
<span id="concurrency"></span><h2>Data Integrity and Concurrency Control<a class="headerlink" href="#data-integrity-and-concurrency-control" title="Permalink to this headline">¶</a></h2>
<p>API responses include a <tt class="docutils literal"><span class="pre">ETag</span></tt> header which also allows for proper
concurrency control. An <tt class="docutils literal"><span class="pre">ETag</span></tt> is a hash value representing the current
state of the resource on the server. Consumers are not allowed to edit or
delete a resource unless they provide an up-to-date <tt class="docutils literal"><span class="pre">ETag</span></tt> for the resource
they are attempting to edit. This prevents overwriting items with obsolete
versions.</p>
<p>Consider the following workflow:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -X PATCH -i http://eve-demo.herokuapp.com/people/521d6840c437dc0002d1203c -d <span class="s1">&#39;{&quot;firstname&quot;: &quot;ronald&quot;}&#39;</span>
<span class="go">HTTP/1.1 403 FORBIDDEN</span>
</pre></div>
</div>
<p>We attempted an edit (<tt class="docutils literal"><span class="pre">PATCH</span></tt>), but we did not provide an <tt class="docutils literal"><span class="pre">ETag</span></tt> for the
item so we got a <tt class="docutils literal"><span class="pre">403</span> <span class="pre">FORBIDDEN</span></tt> back. Let&#8217;s try again:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -H <span class="s2">&quot;If-Match: 1234567890123456789012345678901234567890&quot;</span> -X PATCH -i http://eve-demo.herokuapp.com/people/521d6840c437dc0002d1203c -d <span class="s1">&#39;{&quot;firstname&quot;: &quot;ronald&quot;}&#39;</span>
<span class="go">HTTP/1.1 412 PRECONDITION FAILED</span>
</pre></div>
</div>
<p>What went wrong this time? We provided the mandatory <tt class="docutils literal"><span class="pre">If-Match</span></tt> header, but
it&#8217;s value did not match the <tt class="docutils literal"><span class="pre">ETag</span></tt> computed on the representation of the item
currently stored on the server, so we got a <tt class="docutils literal"><span class="pre">412</span> <span class="pre">PRECONDITION</span> <span class="pre">FAILED</span></tt>. Again!</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -H <span class="s2">&quot;If-Match: 80b81f314712932a4d4ea75ab0b76a4eea613012&quot;</span> -X PATCH -i http://eve-demo.herokuapp.com/people/50adfa4038345b1049c88a37 -d <span class="s1">&#39;{&quot;firstname&quot;: &quot;ronald&quot;}&#39;</span>
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>Finally! And the response payload looks something like this:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;_status&quot;</span><span class="o">:</span> <span class="s2">&quot;OK&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_updated&quot;</span><span class="o">:</span> <span class="s2">&quot;Fri, 23 Nov 2012 08:11:19 GMT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_id&quot;</span><span class="o">:</span> <span class="s2">&quot;50adfa4038345b1049c88a37&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_etag&quot;</span><span class="o">:</span> <span class="s2">&quot;372fbbebf54dfe61742556f17a8461ca9a6f5a11&quot;</span>
    <span class="s2">&quot;_links&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;self&quot;</span><span class="o">:</span> <span class="s2">&quot;...&quot;</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This time we got our patch in, and the server returned the new <tt class="docutils literal"><span class="pre">ETag</span></tt>.  We
also get the new <tt class="docutils literal"><span class="pre">_updated</span></tt> value, which eventually will allow us to perform
subsequent <a class="reference internal" href="#id1">conditional requests</a>.</p>
<p>Concurrency control applies to all edition methods: <tt class="docutils literal"><span class="pre">PATCH</span></tt> (edit), <tt class="docutils literal"><span class="pre">PUT</span></tt>
(replace), <tt class="docutils literal"><span class="pre">DELETE</span></tt> (delete).</p>
<div class="section" id="disabling-concurrency-control">
<h3>Disabling concurrency control<a class="headerlink" href="#disabling-concurrency-control" title="Permalink to this headline">¶</a></h3>
<p>If your use case requires, you can opt to completely disable concurrency
control. ETag match checks can be disabled by setting the <tt class="docutils literal"><span class="pre">IF_MATCH</span></tt>
configuration variable to <tt class="docutils literal"><span class="pre">False</span></tt> (see <a class="reference internal" href="config.html#global"><em>Global Configuration</em></a>). When concurrency
control is disabled no etag is provided with responses. You should be careful
about disabling this feature, as you would effectively open your API to the
risk of older versions replacing your documents.</p>
</div>
</div>
<div class="section" id="bulk-inserts">
<h2>Bulk Inserts<a class="headerlink" href="#bulk-inserts" title="Permalink to this headline">¶</a></h2>
<p>A client may submit a single document for insertion:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -d <span class="s1">&#39;{&quot;firstname&quot;: &quot;barack&quot;, &quot;lastname&quot;: &quot;obama&quot;}&#39;</span> -H <span class="s1">&#39;Content-Type: application/json&#39;</span> http://eve-demo.herokuapp.com/people
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>In this case the response payload will just contain the relevant document
metadata:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;_status&quot;</span><span class="o">:</span> <span class="s2">&quot;OK&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_updated&quot;</span><span class="o">:</span> <span class="s2">&quot;Thu, 22 Nov 2012 15:22:27 GMT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_id&quot;</span><span class="o">:</span> <span class="s2">&quot;50ae43339fa12500024def5b&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_etag&quot;</span><span class="o">:</span> <span class="s2">&quot;749093d334ebd05cf7f2b7dbfb7868605578db2c&quot;</span>
    <span class="s2">&quot;_links&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;self&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;href&quot;</span><span class="o">:</span> <span class="s2">&quot;eve-demo.herokuapp.com/people/50ae43339fa12500024def5b&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;person&quot;</span><span class="p">}}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>However, in order to reduce the number of loopbacks, a client might also submit
multiple documents with a single request. All if needs to do is enclose the
documents in a JSON list:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -d <span class="s1">&#39;[{&quot;firstname&quot;: &quot;barack&quot;, &quot;lastname&quot;: &quot;obama&quot;}, {&quot;firstname&quot;: &quot;mitt&quot;, &quot;lastname&quot;: &quot;romney&quot;}]&#39;</span> -H <span class="s1">&#39;Content-Type: application/json&#39;</span> http://eve-demo.herokuapp.com/people
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>The response will be a list itself, with the state of each document:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;_status&quot;</span><span class="o">:</span> <span class="s2">&quot;OK&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_updated&quot;</span><span class="o">:</span> <span class="s2">&quot;Thu, 22 Nov 2012 15:22:27 GMT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_id&quot;</span><span class="o">:</span> <span class="s2">&quot;50ae43339fa12500024def5b&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_etag&quot;</span><span class="o">:</span> <span class="s2">&quot;749093d334ebd05cf7f2b7dbfb7868605578db2c&quot;</span>
        <span class="s2">&quot;_links&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;self&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;href&quot;</span><span class="o">:</span> <span class="s2">&quot;eve-demo.herokuapp.com/people/50ae43339fa12500024def5b&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;person&quot;</span><span class="p">}}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;_status&quot;</span><span class="o">:</span> <span class="s2">&quot;OK&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_updated&quot;</span><span class="o">:</span> <span class="s2">&quot;Thu, 22 Nov 2012 15:22:27 GMT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_id&quot;</span><span class="o">:</span> <span class="s2">&quot;50ae43339fa12500024def5c&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_etag&quot;</span><span class="o">:</span> <span class="s2">&quot;62d356f623c7d9dc864ffa5facc47dced4ba6907&quot;</span>
        <span class="s2">&quot;_links&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;self&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;href&quot;</span><span class="o">:</span> <span class="s2">&quot;eve-demo.herokuapp.com/people/50ae43339fa12500024def5c&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;person&quot;</span><span class="p">}}</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Evenutal validation errors on one document won&#8217;t prevent the insertion of other
submitted documents.</p>
<p>When multiple documents are submitted the API takes advantage of MongoDB <em>bulk
insert</em> capabilities which means that not only there&#8217;s just one single request
traveling from the client to the remote API, but also that only one loopback is
performed between the API server and the database.</p>
</div>
<div class="section" id="data-validation">
<h2>Data Validation<a class="headerlink" href="#data-validation" title="Permalink to this headline">¶</a></h2>
<p>Data validation is provided out-of-the-box. Your configuration includes
a schema definition for every resource managed by the API. Data sent to the API
to be inserted/updated will be validated against the schema, and a resource
will only be updated if validation passes.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -d <span class="s1">&#39;[{&quot;firstname&quot;: &quot;bill&quot;, &quot;lastname&quot;: &quot;clinton&quot;}, {&quot;firstname&quot;: &quot;mitt&quot;, &quot;lastname&quot;: &quot;romney&quot;}]&#39;</span> -H <span class="s1">&#39;Content-Type: application/json&#39;</span> http://eve-demo.herokuapp.com/people
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>The response will contain a success/error state for each item provided in the
request:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;_status&quot;</span><span class="o">:</span> <span class="s2">&quot;ERR&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_issues&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;lastname&quot;</span><span class="o">:</span> <span class="s2">&quot;value &#39;clinton&#39; not unique&quot;</span><span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;_status&quot;</span><span class="o">:</span> <span class="s2">&quot;OK&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_updated&quot;</span><span class="o">:</span> <span class="s2">&quot;Thu, 22 Nov 2012 15:29:08 GMT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_id&quot;</span><span class="o">:</span> <span class="s2">&quot;50ae44c49fa12500024def5d&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_links&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;self&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;href&quot;</span><span class="o">:</span> <span class="s2">&quot;eve-demo.herokuapp.com/people/50ae44c49fa12500024def5d&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;person&quot;</span><span class="p">}}</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>In the example above, the first document did not validate and was rejected,
while the second was successfully created. The API maintainer has complete
control on data validation. Optionally, you can decide to allow for unknown
fields to be inserted/updated on one or more endpoints. For more information
see <a class="reference internal" href="validation.html#validation"><em>Data Validation</em></a>.</p>
</div>
<div class="section" id="extensible-data-validation">
<h2>Extensible Data Validation<a class="headerlink" href="#extensible-data-validation" title="Permalink to this headline">¶</a></h2>
<p>Data validation is based on the <a class="reference external" href="https://github.com/nicolaiarocci/cerberus">Cerberus</a> validation system and therefore it is
extensible, so you can adapt it to your specific use case. Say that your API can
only accept odd numbers for a certain field value; you can extend the
validation class to validate that. Or say you want to make sure that a VAT
field actually matches your own country VAT algorithm; you can do that too. As
a matter of fact, Eve&#8217;s MongoDB data-layer itself extends Cerberus
validation by implementing the <tt class="docutils literal"><span class="pre">unique</span></tt> schema field constraint. For more
information see <a class="reference internal" href="validation.html#validation"><em>Data Validation</em></a></p>
</div>
<div class="section" id="resource-level-cache-control">
<span id="cache-control"></span><h2>Resource-level Cache Control<a class="headerlink" href="#resource-level-cache-control" title="Permalink to this headline">¶</a></h2>
<p>You can set global and individual cache-control directives for each resource.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://eve-demo.herokuapp.com
<span class="go">HTTP/1.1 200 OK</span>
<span class="go">Content-Type: application/json</span>
<span class="go">Content-Length: 131</span>
<span class="go">Cache-Control: max-age=20</span>
<span class="go">Expires: Tue, 22 Jan 2013 09:34:34 GMT</span>
<span class="go">Server: Eve/0.0.3 Werkzeug/0.8.3 Python/2.7.3</span>
<span class="go">Date: Tue, 22 Jan 2013 09:34:14 GMT</span>
</pre></div>
</div>
<p>The response above includes both <tt class="docutils literal"><span class="pre">Cache-Control</span></tt> and <tt class="docutils literal"><span class="pre">Expires</span></tt> headers.
These will minimize load on the server since cache-enabled consumers will
perform resource-intensive request only when really needed.</p>
</div>
<div class="section" id="versioning">
<h2>Versioning<a class="headerlink" href="#versioning" title="Permalink to this headline">¶</a></h2>
<p>I&#8217;m not too fond of API versioning. I believe that clients should be
intelligent enough to deal with API updates transparently, especially since
Eve-powered API support <a class="reference external" href="http://en.wikipedia.org/wiki/HATEOAS">HATEOAS</a>. When versioning is a necessity, different API
versions should be isolated instances since so many things could be different
between versions: caching, URIs, schemas, validation, and so on. URI versioning
(<a class="reference external" href="http://api.example.com/v1/">http://api.example.com/v1/</a>...) is supported.</p>
</div>
<div class="section" id="authentication">
<h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h2>
<p>Customizable Basic Authentication (RFC-2617), Token-based authentication and
HMAC-based Authentication are supported. You can lockdown the whole API, or
just some endpoints. You can also restrict CRUD commands, like allowing open
read-only access while restricting edits, inserts and deletes to authorized
users. Role-based access control is supported as well. For more information
see <a class="reference internal" href="authentication.html#auth"><em>Authentication and Authorization</em></a>.</p>
</div>
<div class="section" id="cors-cross-origin-resource-sharing">
<h2>CORS Cross-Origin Resource Sharing<a class="headerlink" href="#cors-cross-origin-resource-sharing" title="Permalink to this headline">¶</a></h2>
<p>Disabled by default, <a class="reference external" href="http://en.wikipedia.org/wiki/Cross-origin_resource_sharing">CORS</a> allows web pages to work with REST APIs, something
that is usually restricted by most broswers &#8216;same domain&#8217; security policy.
Eve-powered APIs can be accessed by the JavaScript contained in web pages.</p>
</div>
<div class="section" id="read-only-by-default">
<h2>Read-only by default<a class="headerlink" href="#read-only-by-default" title="Permalink to this headline">¶</a></h2>
<p>If all you need is a read-only API, then you can have it up and running in
a matter of minutes.</p>
</div>
<div class="section" id="default-values">
<h2>Default Values<a class="headerlink" href="#default-values" title="Permalink to this headline">¶</a></h2>
<p>It is possible to set default values for fields. When serving POST
(create) requests, missing fields will be assigned the configured default
values.</p>
</div>
<div class="section" id="predefined-database-filters">
<h2>Predefined Database Filters<a class="headerlink" href="#predefined-database-filters" title="Permalink to this headline">¶</a></h2>
<p>Resource endpoints will only expose (and update) documents that match
a predefined filter. This allows for multiple resource endpoints to seamlessly
target the same database collection. A typical use-case would be a
hypothetical <tt class="docutils literal"><span class="pre">people</span></tt> collection on the database being used by both the
<tt class="docutils literal"><span class="pre">/admins</span></tt> and <tt class="docutils literal"><span class="pre">/users</span></tt> API endpoints.</p>
</div>
<div class="section" id="projections">
<span id="id2"></span><h2>Projections<a class="headerlink" href="#projections" title="Permalink to this headline">¶</a></h2>
<p>This feature allows you to create dynamic <em>views</em> of collections, or more precisely,
to decide what fields should or should not be returned, using a &#8216;projection&#8217;.
Put another way, Projections are conditional queries where the client
dictates which fields should be returned by the API.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://eve-demo.herokuapp.com/people?projection<span class="o">={</span><span class="s2">&quot;lastname&quot;</span>: 1, <span class="s2">&quot;born&quot;</span>: 1<span class="o">}</span>
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>The query above will only return <em>lastname</em> and <em>born</em> out of all the fields
available in the &#8216;people&#8217; resource. You can also exclude fields:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://eve-demo.herokuapp.com/people?projection<span class="o">={</span><span class="s2">&quot;born&quot;</span>: 0<span class="o">}</span>
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>The above will return all fields but <em>born</em>. Please note that key fields such
as ID_FIELD, DATE_CREATED, DATE_UPDATED etc.  will still be included with the
payload. Also keep in mind that some database engines, Mongo included, do not
allow for mixing of inclusive and exclusive selections.</p>
</div>
<div class="section" id="embedded-resource-serialization">
<span id="embedded-docs"></span><h2>Embedded Resource Serialization<a class="headerlink" href="#embedded-resource-serialization" title="Permalink to this headline">¶</a></h2>
<p>If a document field is referencing a document in another resource, clients can
request the referenced document to be embedded within the requested document.</p>
<p>Clients have the power to activate document embedding on per-request basis by
means of a query parameter. Suppose you have a <tt class="docutils literal"><span class="pre">emails</span></tt> resource configured
like this:</p>
<div class="highlight-python"><div class="highlight"><pre> <span class="n">DOMAIN</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s">&#39;emails&#39;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s">&#39;schema&#39;</span><span class="p">:</span> <span class="p">{</span>
             <span class="s">&#39;author:&#39;</span> <span class="p">{</span>
                 <span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;objectid&#39;</span><span class="p">,</span>
                 <span class="s">&#39;data_relation&#39;</span><span class="p">:</span> <span class="p">{</span>
                     <span class="s">&#39;resource&#39;</span><span class="p">:</span> <span class="s">&#39;users&#39;</span><span class="p">,</span>
                     <span class="s">&#39;field&#39;</span><span class="p">:</span> <span class="s">&#39;_id&#39;</span><span class="p">,</span>
<span class="hll">                     <span class="s">&#39;embeddable&#39;</span><span class="p">:</span> <span class="bp">True</span>
</span>                 <span class="p">},</span>
             <span class="p">},</span>
             <span class="s">&#39;subject:&#39;</span> <span class="p">{</span><span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;string&#39;</span><span class="p">},</span>
             <span class="s">&#39;body:&#39;</span> <span class="p">{</span><span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;string&#39;</span><span class="p">},</span>
         <span class="p">}</span>
     <span class="p">}</span>
</pre></div>
</div>
<p>A GET like this: <tt class="docutils literal"><span class="pre">/emails?embedded={&quot;author&quot;:1}</span></tt> would return a fully
embedded users document, whereas the same request without the <tt class="docutils literal"><span class="pre">embedded</span></tt>
argument would just return the user <tt class="docutils literal"><span class="pre">ObjectId</span></tt>. Embedded resource
serialization is available at both resource and item
(<tt class="docutils literal"><span class="pre">/emails/&lt;id&gt;/?embedded={&quot;author&quot;:1}</span></tt>) endpoints.</p>
<p>Embedding can be enabled or disabled both at global level (by setting
<tt class="docutils literal"><span class="pre">EMBEDDING</span></tt> to either <tt class="docutils literal"><span class="pre">True</span></tt> or <tt class="docutils literal"><span class="pre">False</span></tt>) and at resource level (by
toggling the <tt class="docutils literal"><span class="pre">embedding</span></tt> value). Furthermore, only fields with the
<tt class="docutils literal"><span class="pre">embeddable</span></tt> value explicitly set to <tt class="docutils literal"><span class="pre">True</span></tt> will allow the embedding of
referenced documents.</p>
<div class="section" id="predefined-resource-serialization">
<h3>Predefined Resource Serialization<a class="headerlink" href="#predefined-resource-serialization" title="Permalink to this headline">¶</a></h3>
<p>It is also possible to elect some fields for predefined resource
serialization. The <tt class="docutils literal"><span class="pre">embedded_fields</span></tt> option accepts a list of fields. If the
listed fields are embeddable and they are actually referencing documents in other
collections (and embedding is enbaled for the resource), then the referenced
documents will be embedded by default.</p>
</div>
<div class="section" id="limitations">
<h3>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h3>
<p>Currenly we only support a single layer of embedding, i.e.
<tt class="docutils literal"><span class="pre">/emails?embedded={&quot;author&quot;:</span> <span class="pre">1}</span></tt> but <em>not</em>
<tt class="docutils literal"><span class="pre">/emails?embedded={&quot;author.friends&quot;:</span> <span class="pre">1}</span></tt>. This feature is about serialization
on GET requests. There&#8217;s no support for POST, PUT or PATCH of embedded
documents.</p>
<p>Document embedding is enabled by default.</p>
<div class="admonition-please-note admonition">
<p class="first admonition-title">Please note</p>
<p class="last">When it comes to MongoDB, what embedded resource serialization deals with
is <em>document references</em> (linked documents), something different from
<em>embedded documents</em>, also supported by Eve (see <a class="reference external" href="http://docs.mongodb.org/manual/core/data-model-design">MongoDB Data Model
Design</a>). Embedded resource serialization is a nice feature that can
really help with normalizing your data model for the client.  However, when
deciding whether to enable it or not, especially by default, keep in mind
that each embedded resource being looked up will require a database lookup,
which can easily lead to performance issues.</p>
</div>
</div>
</div>
<div class="section" id="event-hooks">
<span id="eventhooks"></span><h2>Event Hooks<a class="headerlink" href="#event-hooks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pre-request-event-hooks">
<h3>Pre-Request Event Hooks<a class="headerlink" href="#pre-request-event-hooks" title="Permalink to this headline">¶</a></h3>
<p>When a GET, POST, PATCH, PUT, DELETE request is received, both
a <tt class="docutils literal"><span class="pre">on_pre_&lt;method&gt;</span></tt> and a <tt class="docutils literal"><span class="pre">on_pre_&lt;method&gt;_&lt;resource&gt;</span></tt> event is raised.
You can subscribe to these events with multiple callback functions. Callbacks
will receive the resource being requested and the original <cite>flask.request</cite>
object as arguments. <tt class="docutils literal"><span class="pre">pre</span></tt> events are raised before any actions is taken by
the API itself.</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">pre_get_callback</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<span class="gp">... </span> <span class="k">print</span> <span class="s">&#39;A GET request on the &quot;</span><span class="si">%s</span><span class="s">&quot; endpoint has just been received!&#39;</span> <span class="o">%</span> <span class="n">resource</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">pre_contacts_get_callback</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="gp">... </span> <span class="k">print</span> <span class="s">&#39;A GET request on the contacts endpoint has just been received!&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">Eve</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">on_pre_GET</span> <span class="o">+=</span> <span class="n">pre_get_callback</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">on_pre_GET_contacts</span> <span class="o">+=</span> <span class="n">pre_contacts_get_callback</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="post-request-event-hooks">
<h3>Post-Request Event Hooks<a class="headerlink" href="#post-request-event-hooks" title="Permalink to this headline">¶</a></h3>
<p>When a GET, POST, PATCH, PUT, DELETE method has been executed, both
a <tt class="docutils literal"><span class="pre">on_post_&lt;method&gt;</span></tt> and <tt class="docutils literal"><span class="pre">on_post_&lt;method&gt;_&lt;resource&gt;</span></tt> event is raised. You
can subscribe to these events with multiple callback functions. Callbacks will
receive the resource accessed, original <cite>flask.request</cite> object and the response
payload.</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">post_get_callback</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">payload</span><span class="p">):</span>
<span class="gp">... </span> <span class="k">print</span> <span class="s">&#39;A GET on the &quot;</span><span class="si">%s</span><span class="s">&quot; endpoint was just performed!&#39;</span> <span class="o">%</span> <span class="n">resource</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">post_contacts_get_callback</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">payload</span><span class="p">):</span>
<span class="gp">... </span><span class="k">print</span> <span class="s">&#39;A get on &quot;contacts&quot; was just performed!&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">Eve</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">on_post_GET</span> <span class="o">+=</span> <span class="n">post_get_callback</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">on_post_GET_contacts</span> <span class="o">+=</span> <span class="n">post_contacts_get_callback</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="the-on-insert-event-hooks">
<h3>The <tt class="docutils literal"><span class="pre">on_insert</span></tt> Event Hooks<a class="headerlink" href="#the-on-insert-event-hooks" title="Permalink to this headline">¶</a></h3>
<p>When documents are about to be stored in the database, both
a <tt class="docutils literal"><span class="pre">on_insert(resource,</span> <span class="pre">documents)</span></tt> and <tt class="docutils literal"><span class="pre">on_insert_&lt;resource&gt;(documents)</span></tt>
event is raised.  Callback functions could hook into these events to
arbitrarily add new fields, or edit existing ones.</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">before_insert</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">documents</span><span class="p">):</span>
<span class="gp">... </span> <span class="k">print</span> <span class="s">&#39;About to store documents to &quot;</span><span class="si">%s</span><span class="s">&quot; &#39;</span> <span class="o">%</span> <span class="n">resource</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">before_insert_contacts</span><span class="p">(</span><span class="n">documents</span><span class="p">):</span>
<span class="gp">... </span> <span class="k">print</span> <span class="s">&#39;About to store contacts&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">Eve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">on_insert</span> <span class="o">+=</span> <span class="n">before_insert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">on_insert_contacts</span> <span class="o">+=</span> <span class="n">before_insert_contacts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">on_insert</span></tt> is raised on every resource being updated while
<tt class="docutils literal"><span class="pre">on_insert_&lt;resource&gt;</span></tt> is raised when the <cite>&lt;resource&gt;</cite> endpoint has been hit
with a POST request. In both circumstances, the event will be raised only if at
least one document passed validation and is going to be inserted. <cite>documents</cite>
is a list and only contains documents ready for insertion (payload documents
that did not pass validation are not included).</p>
</div>
<div class="section" id="the-on-fech-event-hooks">
<h3>The <tt class="docutils literal"><span class="pre">on_fech</span></tt> Event Hooks<a class="headerlink" href="#the-on-fech-event-hooks" title="Permalink to this headline">¶</a></h3>
<p>The following events:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">on_fetch_resource(resource,</span> <span class="pre">documents)</span></tt></li>
<li><tt class="docutils literal"><span class="pre">on_fetch_resource_&lt;resource&gt;(documents)</span></tt></li>
<li><tt class="docutils literal"><span class="pre">on_fetch_item(resource,</span> <span class="pre">_id,</span> <span class="pre">document)</span></tt></li>
<li><tt class="docutils literal"><span class="pre">on_fetch_item_&lt;item_title&gt;(_id,</span> <span class="pre">document)</span></tt></li>
</ul>
<p>are raised when documents have just been read from the database and are about
to be sent to the client. Registered callback functions can manipulate the
documents as needed before they are returned to the client.</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">before_returning_items</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">documents</span><span class="p">):</span>
<span class="gp">... </span> <span class="k">print</span> <span class="s">&#39;About to return items from &quot;</span><span class="si">%s</span><span class="s">&quot; &#39;</span> <span class="o">%</span> <span class="n">resource</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">before_returning_contacts</span><span class="p">(</span><span class="n">documents</span><span class="p">):</span>
<span class="gp">... </span> <span class="k">print</span> <span class="s">&#39;About to return contacts&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">before_returning_item</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">_id</span><span class="p">,</span> <span class="n">document</span><span class="p">):</span>
<span class="gp">... </span> <span class="k">print</span> <span class="s">&#39;About to return an item from &quot;</span><span class="si">%s</span><span class="s">&quot; &#39;</span> <span class="o">%</span> <span class="n">resource</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">before_returning_contact</span><span class="p">(</span><span class="n">_id</span><span class="p">,</span> <span class="n">document</span><span class="p">):</span>
<span class="gp">... </span> <span class="k">print</span> <span class="s">&#39;About to return a contact&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">Eve</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">on_fetch_resource</span> <span class="o">+=</span> <span class="n">before_returning_items</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">on_fetch_resource_contacts</span> <span class="o">+=</span> <span class="n">before_returning_contacts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">on_fetch_item</span> <span class="o">+=</span> <span class="n">before_returning_item</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">on_fetch_item_contact</span> <span class="o">+=</span> <span class="n">before_returning_contact</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Please be aware that <tt class="docutils literal"><span class="pre">last_modified</span></tt> and <tt class="docutils literal"><span class="pre">etag</span></tt> headers will always be
consistent with the state of the documents on the database (they  won&#8217;t be
updated to reflect changes eventually applied by the callback functions).</p>
<div class="admonition-please-note admonition">
<p class="first admonition-title">Please note</p>
<p class="last">To provide seamless event handling features Eve relies on the <a class="reference external" href="https://github.com/nicolaiarocci/events">Events</a> package.</p>
</div>
</div>
</div>
<div class="section" id="rate-limiting">
<span id="ratelimiting"></span><h2>Rate Limiting<a class="headerlink" href="#rate-limiting" title="Permalink to this headline">¶</a></h2>
<p>API rate limiting is supported on a per-user/method basis. You can set the
number of requests and the time window for each HTTP method. If the requests
limit is hit within the time window, the API will respond with <tt class="docutils literal"><span class="pre">429</span> <span class="pre">Request</span>
<span class="pre">limit</span> <span class="pre">exceeded</span></tt> until the timer resets. Users are identified by the
Authentication header or (when missing) by the client IP. When rate limiting
is enabled, appropriate <tt class="docutils literal"><span class="pre">X-RateLimit-</span></tt> headers are provided with every API
response.  Suppose that the rate limit has been set to 300 requests every 15
minutes, this is what a user would get after hitting a endpoint with a single
request:</p>
<div class="highlight-python"><pre>X-RateLimit-Remaining: 299
X-RateLimit-Limit: 300
X-RateLimit-Reset: 1370940300</pre>
</div>
<p>You can set different limits for each one of the supported methods (GET, POST,
PATCH, DELETE).</p>
<div class="admonition-please-note admonition">
<p class="first admonition-title">Please Note</p>
<p class="last">Rate Limiting is disabled by default, and needs a Redis server running when
enabled. A tutorial on Rate Limiting is forthcoming.</p>
</div>
</div>
<div class="section" id="custom-id-fields">
<h2>Custom ID Fields<a class="headerlink" href="#custom-id-fields" title="Permalink to this headline">¶</a></h2>
<p>Eve allows to extend its standard data type support. In the <a class="reference internal" href="tutorials/custom_idfields.html#custom-ids"><em>Handling custom ID fields</em></a>
tutorial we see how it is possible to use UUID values instead of MongoDB
default ObjectIds as unique document identifiers.</p>
</div>
<div class="section" id="file-storage">
<h2>File Storage<a class="headerlink" href="#file-storage" title="Permalink to this headline">¶</a></h2>
<p>Media files (images, pdf, etc.) can be uploaded as <tt class="docutils literal"><span class="pre">media</span></tt> document
fields. Upload is done via <tt class="docutils literal"><span class="pre">POST</span></tt>, <tt class="docutils literal"><span class="pre">PUT</span></tt> and
<tt class="docutils literal"><span class="pre">PATCH</span></tt> as usual, but using the <tt class="docutils literal"><span class="pre">multipart/data-form</span></tt> content-type.</p>
<p>Let us assume that the <tt class="docutils literal"><span class="pre">accounts</span></tt> endpoint has a schema like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">accounts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;string&#39;</span><span class="p">},</span>
    <span class="s">&#39;pic&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;media&#39;</span><span class="p">},</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With curl we would <tt class="docutils literal"><span class="pre">POST</span></tt> like this:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -F <span class="s2">&quot;name=john&quot;</span> -F <span class="s2">&quot;pic=@profile.jpg&quot;</span> http://example.com/accounts
</pre></div>
</div>
<p>For optmized performance files are stored in <a class="reference external" href="http://docs.mongodb.org/manual/core/gridfs/">GridFS</a> by default. Custom
<tt class="docutils literal"><span class="pre">MediaStorage</span></tt> classes can be implemented and passed to the application to
support alternative storage systems. A <tt class="docutils literal"><span class="pre">FileSystemMediaStorage</span></tt> class is in
the works, and will soon be included with the Eve package.</p>
<p>As a proper developer guide is not available yet, you can peek at the
<a class="reference external" href="https://github.com/nicolaiarocci/eve/blob/develop/eve/io/media.py">MediaStorage</a> source if you are interested in developing custom storage
classes.</p>
<p>When a document is requested media files will be returned as Base64 strings.</p>
<div class="section" id="leveraging-projections-to-optimize-the-handling-of-media-files">
<h3>Leveraging Projections to optimize the handling of media files<a class="headerlink" href="#leveraging-projections-to-optimize-the-handling-of-media-files" title="Permalink to this headline">¶</a></h3>
<p>Clients and API maintainers can exploit the <a class="reference internal" href="#projections"><em>Projections</em></a> feature to
include/exclude media fields from response payloads.</p>
<p>Suppose that a client stored a document with an image. The image field is
called <em>image</em> and it is of <tt class="docutils literal"><span class="pre">media</span></tt> type. At a later time, the client wants
to retrieve the same document but, in order to optimize for speed and since the
image is cached already, it does not want to download the image along with the
document. It can do so by requesting the field to be trimmed out of the
response payload:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://example.com/people/&lt;id&gt;?projection<span class="o">={</span><span class="s2">&quot;image&quot;</span>: 0<span class="o">}</span>
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>The document will be returned with all its fields except the <em>image</em> field.</p>
<p>Moreover, when setting the <tt class="docutils literal"><span class="pre">datasource</span></tt> property for any given resource
endpoint it is possible to explictly exclude fields (of <tt class="docutils literal"><span class="pre">media</span></tt> type, but
also of any other type reallt) from default responses:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">people</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;datasource&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;projection&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;image&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="p">},</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now clients will have to explicitly request the image field to be included with
response payloads by sending requests like this one:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> curl -i http://example.com/people/&lt;id&gt;?projection<span class="o">={</span><span class="s2">&quot;image&quot;</span>: 1<span class="o">}</span>
<span class="go">HTTP/1.1 200 OK</span>
</pre></div>
</div>
<p>For details on the <tt class="docutils literal"><span class="pre">datasource</span></tt> setting, see <a class="reference internal" href="config.html#config"><em>Configuration Handling</em></a> and <a class="reference internal" href="config.html#datasource"><em>Advanced Datasource Patterns</em></a>.</p>
</div>
</div>
<div class="section" id="mongodb-support">
<h2>MongoDB Support<a class="headerlink" href="#mongodb-support" title="Permalink to this headline">¶</a></h2>
<p>Support for MongoDB comes out of the box. Extensions for other SQL/NoSQL
backends can be developed with relative ease (a <a class="reference external" href="https://github.com/nicolaiarocci/eve/issues/17">PostgreSQL effort</a> is
ongoing, maybe you can lend a hand?)</p>
</div>
<div class="section" id="powered-by-flask">
<h2>Powered by Flask<a class="headerlink" href="#powered-by-flask" title="Permalink to this headline">¶</a></h2>
<p>Eve is based on the <a class="reference external" href="http://flask.pocoo.org">Flask</a> micro web framework. Actually, Eve itself is
a Flask subclass, which means that Eve exposes all of Flask functionalities and
niceties, like a built-in development server and <a class="reference external" href="http://flask.pocoo.org/docs/quickstart/#debug-mode">debugger</a>, integrated support
for <a class="reference external" href="http://flask.pocoo.org/docs/testing/">unittesting</a> and an <a class="reference external" href="http://flask.pocoo.org/docs/">extensive documentation</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><p class="logo">
  <a href="index.html">
      <img class="logo" src="_static/eve-sidebar.png" alt="Logo"/>
  </a>
</p>
<p>
  <iframe src="http://ghbtns.com/github-btn.html?user=nicolaiarocci&repo=eve&type=watch&count=true&size=large"
    allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p> 
<!--<h3>About Eve</h3>-->
<p>
  You are looking at the documentation of the development version.
</p>
<h3>Support Eve</h3>
<p>If your organization uses Eve, consider financial support:</p>
<p>
<a href="https://gum.co/EhzI" class="gumroad-button">Eve Pro</a> <script type="text/javascript" src="https://gumroad.com/js/gumroad.js"></script>
</p>
<h3>Get Updates</h3>
<p>Receive updates on new releases and upcoming projects.</p>
<p>
<a href="http://tinyletter.com/nicolaiarocci">Subscribe to Newsletter</a>
</p>
<h3>Useful Links</h3>
<ul>
  <li><a href="http://stackoverflow.com/questions/tagged/eve">Stack Overflow</a></li>
  <li><a href="https://groups.google.com/forum/#!forum/python-eve">Mailing List</a></li>
  <li><a href="http://github.com/nicolaiarocci/eve/issues">Issue Tracker</a></li>
  <li><a href="http://github.com/nicolaiarocci/eve">GitHub</a></li>
  <li><a href="http://blog.python-eve.org/">Blog</a></li>
  <li><a href="http://github.com/nicolaiarocci/eve-demo">Demo</a></li>
  <li><a href="irc://irc.freenode.net/python-eve">IRC</a>
</ul>
<h3>Feedback</h3>
<p>
  Feedback is greatly appreciated. If you have any questions, comments,
  random praise, or anonymous threats, get on the <a href="https://groups.google.com/forum/#!forum/python-eve">mailing list</a> or <a href="mailto:eve@nicolaiarocci.com">
  shoot an email</a>.
</p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Features</a><ul>
<li><a class="reference internal" href="#emphasis-on-rest">Emphasis on REST</a></li>
<li><a class="reference internal" href="#full-range-of-crud-operations">Full range of CRUD operations</a><ul>
<li><a class="reference internal" href="#overriding-http-methods">Overriding HTTP Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#customizable-resource-endpoints">Customizable resource endpoints</a><ul>
<li><a class="reference internal" href="#sub-resources">Sub Resources</a></li>
</ul>
</li>
<li><a class="reference internal" href="#customizable-multiple-item-endpoints">Customizable, multiple item endpoints</a></li>
<li><a class="reference internal" href="#filtering-and-sorting">Filtering and Sorting</a></li>
<li><a class="reference internal" href="#pagination">Pagination</a></li>
<li><a class="reference internal" href="#hateoas">HATEOAS</a><ul>
<li><a class="reference internal" href="#disabling-hateoas">Disabling HATEOAS</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-and-xml-rendering">JSON and XML Rendering</a></li>
<li><a class="reference internal" href="#conditional-requests">Conditional Requests</a></li>
<li><a class="reference internal" href="#data-integrity-and-concurrency-control">Data Integrity and Concurrency Control</a><ul>
<li><a class="reference internal" href="#disabling-concurrency-control">Disabling concurrency control</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bulk-inserts">Bulk Inserts</a></li>
<li><a class="reference internal" href="#data-validation">Data Validation</a></li>
<li><a class="reference internal" href="#extensible-data-validation">Extensible Data Validation</a></li>
<li><a class="reference internal" href="#resource-level-cache-control">Resource-level Cache Control</a></li>
<li><a class="reference internal" href="#versioning">Versioning</a></li>
<li><a class="reference internal" href="#authentication">Authentication</a></li>
<li><a class="reference internal" href="#cors-cross-origin-resource-sharing">CORS Cross-Origin Resource Sharing</a></li>
<li><a class="reference internal" href="#read-only-by-default">Read-only by default</a></li>
<li><a class="reference internal" href="#default-values">Default Values</a></li>
<li><a class="reference internal" href="#predefined-database-filters">Predefined Database Filters</a></li>
<li><a class="reference internal" href="#projections">Projections</a></li>
<li><a class="reference internal" href="#embedded-resource-serialization">Embedded Resource Serialization</a><ul>
<li><a class="reference internal" href="#predefined-resource-serialization">Predefined Resource Serialization</a></li>
<li><a class="reference internal" href="#limitations">Limitations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#event-hooks">Event Hooks</a><ul>
<li><a class="reference internal" href="#pre-request-event-hooks">Pre-Request Event Hooks</a></li>
<li><a class="reference internal" href="#post-request-event-hooks">Post-Request Event Hooks</a></li>
<li><a class="reference internal" href="#the-on-insert-event-hooks">The <tt class="docutils literal"><span class="pre">on_insert</span></tt> Event Hooks</a></li>
<li><a class="reference internal" href="#the-on-fech-event-hooks">The <tt class="docutils literal"><span class="pre">on_fech</span></tt> Event Hooks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rate-limiting">Rate Limiting</a></li>
<li><a class="reference internal" href="#custom-id-fields">Custom ID Fields</a></li>
<li><a class="reference internal" href="#file-storage">File Storage</a><ul>
<li><a class="reference internal" href="#leveraging-projections-to-optimize-the-handling-of-media-files">Leveraging Projections to optimize the handling of media files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mongodb-support">MongoDB Support</a></li>
<li><a class="reference internal" href="#powered-by-flask">Powered by Flask</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="quickstart.html" title="previous chapter">Quickstart</a></li>
      <li>Next: <a href="config.html" title="next chapter">Configuration Handling</a></li>
  </ul></li>
</ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2014. A <a href="http://nicolaiarocci.com">Nicola Iarocci</a> Project.
  </div>
  <a href="https://github.com/nicolaiarocci/eve" class="github">
      <img style="position: absolute; top: 0; right: 0; border: 0;" src="_static/forkme_right_green_007200.png" alt="Fork me on GitHub"  class="github"/>
  </a>
  
  </body>
</html>